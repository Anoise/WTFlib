Args in experiment:
Namespace(random_seed=2023, is_training=1, model_id='CBSU_36_48', model='PatchTST', data='CBSU', root_path='../data_trfc/CBS/', n_part=24, features='M', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=36, pred_len=48, num_workers=10, itr=1, train_epochs=100, batch_size=128, patience=3, learning_rate=0.0001, weight_decay=0.0, des='test', loss='mse', lradj='TST', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False, max_diffusion_step=2, cl_decay_steps=2000, filter_type='dual_random_walk', num_rnn_layers=2, rnn_units=64, use_curriculum_learning=False, patch_len=2, stride=2, fc_dropout=0.05, head_dropout=0.0, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=185, dec_in=185, c_out=185, d_model=512, n_heads=8, e_layers=2, d_layers=1, d_ff=2048, moving_avg=25, factor=1, distil=True, dropout=0.05, embed='timeF', activation='gelu', output_attention=False, do_predict=False, version='Fourier', mode_select='random', modes=64, L=3, base='legendre', cross_activation='tanh', label_len=18)
Use GPU: cuda:0
0 ---->>>>
>>>>>>>start training : CBSU_36_48_PatchTST_CBSU_ftM_sl36_ll18_pl48_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_test_0>>>>>>>>>>>>>>>>>>>>>>>>>>
load CBSU ...
data shape:  (720, 4454) 4454
data shape:  (2592, 4454) 4454
data shape:  (720, 4454) 4454
	iters: 100, epoch: 1 | loss: 0.0402743
	speed: 0.0308s/iter; left time: 7734.9752s
	iters: 200, epoch: 1 | loss: 0.0292020
	speed: 0.0282s/iter; left time: 7069.7955s
	iters: 300, epoch: 1 | loss: 0.0179372
	speed: 0.0282s/iter; left time: 7056.2944s
	iters: 400, epoch: 1 | loss: 0.0455636
	speed: 0.0281s/iter; left time: 7044.6556s
	iters: 500, epoch: 1 | loss: 0.0473756
	speed: 0.0282s/iter; left time: 7049.2760s
	iters: 600, epoch: 1 | loss: 0.0902283
	speed: 0.0281s/iter; left time: 7035.9763s
	iters: 700, epoch: 1 | loss: 0.0630219
	speed: 0.0281s/iter; left time: 7038.2584s
	iters: 800, epoch: 1 | loss: 0.0477541
	speed: 0.0281s/iter; left time: 7031.8975s
	iters: 900, epoch: 1 | loss: 0.0685466
	speed: 0.0282s/iter; left time: 7038.3657s
	iters: 1000, epoch: 1 | loss: 0.0409384
	speed: 0.0282s/iter; left time: 7039.9975s
	iters: 1100, epoch: 1 | loss: 0.0914419
	speed: 0.0282s/iter; left time: 7043.2999s
	iters: 1200, epoch: 1 | loss: 0.0484068
	speed: 0.0281s/iter; left time: 7025.8560s
	iters: 1300, epoch: 1 | loss: 0.1409908
	speed: 0.0278s/iter; left time: 6933.7762s
	iters: 1400, epoch: 1 | loss: 0.0310638
	speed: 0.0282s/iter; left time: 7034.4599s
	iters: 1500, epoch: 1 | loss: 0.0567405
	speed: 0.0282s/iter; left time: 7032.5330s
	iters: 1600, epoch: 1 | loss: 0.0715596
	speed: 0.0282s/iter; left time: 7041.4178s
	iters: 1700, epoch: 1 | loss: 0.0384715
	speed: 0.0282s/iter; left time: 7034.8912s
	iters: 1800, epoch: 1 | loss: 0.0475369
	speed: 0.0282s/iter; left time: 7035.8675s
	iters: 1900, epoch: 1 | loss: 0.0597141
	speed: 0.0282s/iter; left time: 7023.7533s
	iters: 2000, epoch: 1 | loss: 0.0374647
	speed: 0.0282s/iter; left time: 7027.1006s
	iters: 2100, epoch: 1 | loss: 0.0774057
	speed: 0.0283s/iter; left time: 7029.6789s
	iters: 2200, epoch: 1 | loss: 0.0374099
	speed: 0.0282s/iter; left time: 7010.4098s
	iters: 2300, epoch: 1 | loss: 0.1041818
	speed: 0.0282s/iter; left time: 7013.3196s
	iters: 2400, epoch: 1 | loss: 0.0556262
	speed: 0.0283s/iter; left time: 7036.8463s
	iters: 2500, epoch: 1 | loss: 0.0302594
	speed: 0.0282s/iter; left time: 7000.4722s
Epoch: 1 cost time: 70.96002054214478
Epoch: 1, Steps: 2509 | Train Loss: 0.0578432 Vali Loss: 0.0928010 Test Loss: 0.0169115
Validation loss decreased (inf --> 0.092801).  Saving model ...
Updating learning rate to 4.262956002897106e-06
	iters: 100, epoch: 2 | loss: 0.0182707
	speed: 0.3330s/iter; left time: 82682.3216s
	iters: 200, epoch: 2 | loss: 0.0102132
	speed: 0.0282s/iter; left time: 7001.9540s
	iters: 300, epoch: 2 | loss: 0.0101336
	speed: 0.0282s/iter; left time: 6994.4345s
	iters: 400, epoch: 2 | loss: 0.0157625
	speed: 0.0282s/iter; left time: 7000.1240s
	iters: 500, epoch: 2 | loss: 0.0148273
	speed: 0.0282s/iter; left time: 6996.9904s
	iters: 600, epoch: 2 | loss: 0.0264817
	speed: 0.0282s/iter; left time: 6993.3549s
	iters: 700, epoch: 2 | loss: 0.0227785
	speed: 0.0282s/iter; left time: 6992.4141s
	iters: 800, epoch: 2 | loss: 0.0185270
	speed: 0.0282s/iter; left time: 6986.9318s
	iters: 900, epoch: 2 | loss: 0.0345177
	speed: 0.0282s/iter; left time: 6991.3175s
	iters: 1000, epoch: 2 | loss: 0.0230529
	speed: 0.0282s/iter; left time: 6981.5114s
	iters: 1100, epoch: 2 | loss: 0.0203547
	speed: 0.0283s/iter; left time: 6992.8944s
	iters: 1200, epoch: 2 | loss: 0.0181119
	speed: 0.0282s/iter; left time: 6972.1379s
	iters: 1300, epoch: 2 | loss: 0.0243021
	speed: 0.0282s/iter; left time: 6970.0326s
	iters: 1400, epoch: 2 | loss: 0.0147808
	speed: 0.0282s/iter; left time: 6968.2240s
	iters: 1500, epoch: 2 | loss: 0.0143442
	speed: 0.0282s/iter; left time: 6965.7995s
	iters: 1600, epoch: 2 | loss: 0.0220484
	speed: 0.0282s/iter; left time: 6955.0283s
	iters: 1700, epoch: 2 | loss: 0.0189954
	speed: 0.0282s/iter; left time: 6955.1456s
	iters: 1800, epoch: 2 | loss: 0.0213347
	speed: 0.0282s/iter; left time: 6953.7155s
	iters: 1900, epoch: 2 | loss: 0.0231478
	speed: 0.0282s/iter; left time: 6950.2098s
	iters: 2000, epoch: 2 | loss: 0.0156677
	speed: 0.0282s/iter; left time: 6948.2830s
	iters: 2100, epoch: 2 | loss: 0.0237197
	speed: 0.0282s/iter; left time: 6944.3303s
	iters: 2200, epoch: 2 | loss: 0.0158428
	speed: 0.0282s/iter; left time: 6946.4436s
	iters: 2300, epoch: 2 | loss: 0.0216382
	speed: 0.0283s/iter; left time: 6952.1531s
	iters: 2400, epoch: 2 | loss: 0.0222627
	speed: 0.0283s/iter; left time: 6951.1438s
	iters: 2500, epoch: 2 | loss: 0.0148355
	speed: 0.0282s/iter; left time: 6945.5011s
Epoch: 2 cost time: 70.82702708244324
Epoch: 2, Steps: 2509 | Train Loss: 0.0194458 Vali Loss: 0.0926072 Test Loss: 0.0155735
Validation loss decreased (0.092801 --> 0.092607).  Saving model ...
Updating learning rate to 5.048942934110929e-06
	iters: 100, epoch: 3 | loss: 0.0206643
	speed: 0.3403s/iter; left time: 83631.1726s
	iters: 200, epoch: 3 | loss: 0.0150082
	speed: 0.0281s/iter; left time: 6907.9365s
	iters: 300, epoch: 3 | loss: 0.0148725
	speed: 0.0282s/iter; left time: 6918.4107s
	iters: 400, epoch: 3 | loss: 0.0263815
	speed: 0.0282s/iter; left time: 6920.1558s
	iters: 500, epoch: 3 | loss: 0.0224287
	speed: 0.0281s/iter; left time: 6886.8470s
	iters: 600, epoch: 3 | loss: 0.0994490
	speed: 0.0282s/iter; left time: 6911.1476s
	iters: 700, epoch: 3 | loss: 0.0389126
	speed: 0.0282s/iter; left time: 6909.8937s
	iters: 800, epoch: 3 | loss: 0.0331725
	speed: 0.0282s/iter; left time: 6908.9809s
	iters: 900, epoch: 3 | loss: 0.0423608
	speed: 0.0282s/iter; left time: 6907.0316s
	iters: 1000, epoch: 3 | loss: 0.0262741
	speed: 0.0282s/iter; left time: 6906.3123s
	iters: 1100, epoch: 3 | loss: 0.0430053
	speed: 0.0282s/iter; left time: 6893.8328s
	iters: 1200, epoch: 3 | loss: 0.0606421
	speed: 0.0282s/iter; left time: 6893.2688s
	iters: 1300, epoch: 3 | loss: 0.0304987
	speed: 0.0282s/iter; left time: 6908.0494s
	iters: 1400, epoch: 3 | loss: 0.0200795
	speed: 0.0282s/iter; left time: 6899.4951s
	iters: 1500, epoch: 3 | loss: 0.0307676
	speed: 0.0282s/iter; left time: 6892.4016s
	iters: 1600, epoch: 3 | loss: 0.0449073
	speed: 0.0282s/iter; left time: 6891.6448s
	iters: 1700, epoch: 3 | loss: 0.0315109
	speed: 0.0282s/iter; left time: 6889.1939s
	iters: 1800, epoch: 3 | loss: 0.0391430
	speed: 0.0282s/iter; left time: 6886.6338s
	iters: 1900, epoch: 3 | loss: 0.1396230
	speed: 0.0282s/iter; left time: 6890.8324s
	iters: 2000, epoch: 3 | loss: 0.0210154
	speed: 0.0282s/iter; left time: 6883.3453s
	iters: 2100, epoch: 3 | loss: 0.0574697
	speed: 0.0282s/iter; left time: 6880.5363s
	iters: 2200, epoch: 3 | loss: 0.0295169
	speed: 0.0282s/iter; left time: 6878.4645s
	iters: 2300, epoch: 3 | loss: 0.0684136
	speed: 0.0282s/iter; left time: 6869.2971s
	iters: 2400, epoch: 3 | loss: 0.0624457
	speed: 0.0282s/iter; left time: 6872.2751s
	iters: 2500, epoch: 3 | loss: 0.0245994
	speed: 0.0282s/iter; left time: 6874.1865s
Epoch: 3 cost time: 70.73586177825928
Epoch: 3, Steps: 2509 | Train Loss: 0.0406425 Vali Loss: 0.0927413 Test Loss: 0.0169617
EarlyStopping counter: 1 out of 3
Updating learning rate to 6.349349127734755e-06
	iters: 100, epoch: 4 | loss: 0.0207915
	speed: 0.1533s/iter; left time: 37290.0870s
	iters: 200, epoch: 4 | loss: 0.0183164
	speed: 0.0282s/iter; left time: 6851.1112s
	iters: 300, epoch: 4 | loss: 0.0104066
	speed: 0.0282s/iter; left time: 6850.1964s
	iters: 400, epoch: 4 | loss: 0.0252583
	speed: 0.0282s/iter; left time: 6854.4503s
	iters: 500, epoch: 4 | loss: 0.0244945
	speed: 0.0283s/iter; left time: 6864.7657s
	iters: 600, epoch: 4 | loss: 0.0346351
	speed: 0.0282s/iter; left time: 6850.0318s
	iters: 700, epoch: 4 | loss: 0.0264581
	speed: 0.0282s/iter; left time: 6852.5343s
	iters: 800, epoch: 4 | loss: 0.0309565
	speed: 0.0282s/iter; left time: 6847.2364s
	iters: 900, epoch: 4 | loss: 0.0419016
	speed: 0.0282s/iter; left time: 6848.0551s
	iters: 1000, epoch: 4 | loss: 0.0175912
	speed: 0.0283s/iter; left time: 6860.4045s
	iters: 1100, epoch: 4 | loss: 0.0443389
	speed: 0.0282s/iter; left time: 6841.0088s
	iters: 1200, epoch: 4 | loss: 0.0272941
	speed: 0.0282s/iter; left time: 6835.1908s
	iters: 1300, epoch: 4 | loss: 0.0649368
	speed: 0.0282s/iter; left time: 6838.1318s
	iters: 1400, epoch: 4 | loss: 0.0197929
	speed: 0.0282s/iter; left time: 6821.7986s
	iters: 1500, epoch: 4 | loss: 0.0358710
	speed: 0.0282s/iter; left time: 6826.9888s
	iters: 1600, epoch: 4 | loss: 0.0370104
	speed: 0.0283s/iter; left time: 6832.9563s
	iters: 1700, epoch: 4 | loss: 0.0338309
	speed: 0.0282s/iter; left time: 6827.2468s
	iters: 1800, epoch: 4 | loss: 0.0373261
	speed: 0.0283s/iter; left time: 6835.0436s
	iters: 1900, epoch: 4 | loss: 0.0472954
	speed: 0.0283s/iter; left time: 6827.4093s
	iters: 2000, epoch: 4 | loss: 0.0200771
	speed: 0.0282s/iter; left time: 6816.7911s
	iters: 2100, epoch: 4 | loss: 0.0419547
	speed: 0.0282s/iter; left time: 6809.8574s
	iters: 2200, epoch: 4 | loss: 0.0265681
	speed: 0.0284s/iter; left time: 6860.0077s
	iters: 2300, epoch: 4 | loss: 0.0655336
	speed: 0.0283s/iter; left time: 6812.2000s
	iters: 2400, epoch: 4 | loss: 0.0409958
	speed: 0.0283s/iter; left time: 6812.2784s
	iters: 2500, epoch: 4 | loss: 0.0256483
	speed: 0.0283s/iter; left time: 6809.0322s
Epoch: 4 cost time: 70.85578775405884
Epoch: 4, Steps: 2509 | Train Loss: 0.0328870 Vali Loss: 0.0896502 Test Loss: 0.0163392
Validation loss decreased (0.092607 --> 0.089650).  Saving model ...
Updating learning rate to 8.149926683151146e-06
	iters: 100, epoch: 5 | loss: 0.0302054
	speed: 0.3427s/iter; left time: 82509.3911s
	iters: 200, epoch: 5 | loss: 0.0143128
	speed: 0.0282s/iter; left time: 6777.3404s
	iters: 300, epoch: 5 | loss: 0.0122975
	speed: 0.0282s/iter; left time: 6787.0214s
	iters: 400, epoch: 5 | loss: 0.0143637
	speed: 0.0282s/iter; left time: 6776.8497s
	iters: 500, epoch: 5 | loss: 0.0170211
	speed: 0.0282s/iter; left time: 6785.7377s
	iters: 600, epoch: 5 | loss: 0.0271499
	speed: 0.0282s/iter; left time: 6776.7474s
	iters: 700, epoch: 5 | loss: 0.0215446
	speed: 0.0282s/iter; left time: 6770.5961s
	iters: 800, epoch: 5 | loss: 0.0251008
	speed: 0.0282s/iter; left time: 6766.1159s
	iters: 900, epoch: 5 | loss: 0.0315214
	speed: 0.0283s/iter; left time: 6789.5424s
	iters: 1000, epoch: 5 | loss: 0.0162304
	speed: 0.0282s/iter; left time: 6766.0955s
	iters: 1100, epoch: 5 | loss: 0.0268711
	speed: 0.0283s/iter; left time: 6775.6119s
	iters: 1200, epoch: 5 | loss: 0.0226941
	speed: 0.0282s/iter; left time: 6770.1809s
	iters: 1300, epoch: 5 | loss: 0.0403253
	speed: 0.0281s/iter; left time: 6739.1239s
	iters: 1400, epoch: 5 | loss: 0.0156461
	speed: 0.0282s/iter; left time: 6764.8310s
	iters: 1500, epoch: 5 | loss: 0.0201693
	speed: 0.0282s/iter; left time: 6751.3044s
	iters: 1600, epoch: 5 | loss: 0.0221648
	speed: 0.0282s/iter; left time: 6749.6311s
	iters: 1700, epoch: 5 | loss: 0.0222772
	speed: 0.0282s/iter; left time: 6741.1028s
	iters: 1800, epoch: 5 | loss: 0.0232984
	speed: 0.0282s/iter; left time: 6741.4487s
	iters: 1900, epoch: 5 | loss: 0.0348677
	speed: 0.0282s/iter; left time: 6736.7111s
	iters: 2000, epoch: 5 | loss: 0.0185218
	speed: 0.0281s/iter; left time: 6715.2887s
	iters: 2100, epoch: 5 | loss: 0.0284192
	speed: 0.0283s/iter; left time: 6752.6586s
	iters: 2200, epoch: 5 | loss: 0.0203338
	speed: 0.0283s/iter; left time: 6747.7547s
	iters: 2300, epoch: 5 | loss: 0.0432329
	speed: 0.0283s/iter; left time: 6743.8990s
	iters: 2400, epoch: 5 | loss: 0.0291205
	speed: 0.0283s/iter; left time: 6738.6450s
	iters: 2500, epoch: 5 | loss: 0.0163351
	speed: 0.0282s/iter; left time: 6732.7151s
Epoch: 5 cost time: 70.82982611656189
Epoch: 5, Steps: 2509 | Train Loss: 0.0246962 Vali Loss: 0.0901835 Test Loss: 0.0158421
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.0430947572156869e-05
	iters: 100, epoch: 6 | loss: 0.0183283
	speed: 0.1539s/iter; left time: 36663.1673s
	iters: 200, epoch: 6 | loss: 0.0122022
	speed: 0.0283s/iter; left time: 6732.1072s
	iters: 300, epoch: 6 | loss: 0.0143811
	speed: 0.0282s/iter; left time: 6719.4473s
	iters: 400, epoch: 6 | loss: 0.0229863
	speed: 0.0283s/iter; left time: 6723.3214s
	iters: 500, epoch: 6 | loss: 0.0178507
	speed: 0.0283s/iter; left time: 6731.3065s
	iters: 600, epoch: 6 | loss: 0.0427821
	speed: 0.0282s/iter; left time: 6713.2848s
	iters: 700, epoch: 6 | loss: 0.0438598
	speed: 0.0282s/iter; left time: 6711.1100s
	iters: 800, epoch: 6 | loss: 0.0357103
	speed: 0.0282s/iter; left time: 6698.0284s
	iters: 900, epoch: 6 | loss: 0.0425748
	speed: 0.0282s/iter; left time: 6686.5288s
	iters: 1000, epoch: 6 | loss: 0.0206601
	speed: 0.0283s/iter; left time: 6723.6304s
	iters: 1100, epoch: 6 | loss: 0.0854813
	speed: 0.0284s/iter; left time: 6731.6556s
	iters: 1200, epoch: 6 | loss: 0.0316130
	speed: 0.0287s/iter; left time: 6797.1730s
	iters: 1300, epoch: 6 | loss: 0.0551374
	speed: 0.0282s/iter; left time: 6685.0367s
	iters: 1400, epoch: 6 | loss: 0.0179557
	speed: 0.0282s/iter; left time: 6692.0038s
	iters: 1500, epoch: 6 | loss: 0.0319205
	speed: 0.0283s/iter; left time: 6694.6376s
	iters: 1600, epoch: 6 | loss: 0.0659370
	speed: 0.0283s/iter; left time: 6690.0872s
	iters: 1700, epoch: 6 | loss: 0.0512032
	speed: 0.0282s/iter; left time: 6685.2827s
	iters: 1800, epoch: 6 | loss: 0.0690908
	speed: 0.0282s/iter; left time: 6675.6820s
	iters: 1900, epoch: 6 | loss: 0.0727226
	speed: 0.0282s/iter; left time: 6675.8383s
	iters: 2000, epoch: 6 | loss: 0.0242302
	speed: 0.0282s/iter; left time: 6676.0794s
	iters: 2100, epoch: 6 | loss: 0.0847440
	speed: 0.0282s/iter; left time: 6669.1970s
	iters: 2200, epoch: 6 | loss: 0.0338113
	speed: 0.0283s/iter; left time: 6678.0487s
	iters: 2300, epoch: 6 | loss: 0.0860472
	speed: 0.0282s/iter; left time: 6657.9333s
	iters: 2400, epoch: 6 | loss: 0.0614572
	speed: 0.0282s/iter; left time: 6660.4662s
	iters: 2500, epoch: 6 | loss: 0.0292734
	speed: 0.0282s/iter; left time: 6651.5490s
Epoch: 6 cost time: 70.9025182723999
Epoch: 6, Steps: 2509 | Train Loss: 0.0434447 Vali Loss: 0.0877403 Test Loss: 0.0173102
Validation loss decreased (0.089650 --> 0.087740).  Saving model ...
Updating learning rate to 1.3167419789106164e-05
	iters: 100, epoch: 7 | loss: 0.0215312
	speed: 0.3425s/iter; left time: 80745.7127s
	iters: 200, epoch: 7 | loss: 0.0146272
	speed: 0.0282s/iter; left time: 6651.7506s
	iters: 300, epoch: 7 | loss: 0.0134997
	speed: 0.0282s/iter; left time: 6650.6519s
	iters: 400, epoch: 7 | loss: 0.0109483
	speed: 0.0281s/iter; left time: 6623.3716s
	iters: 500, epoch: 7 | loss: 0.0131097
	speed: 0.0282s/iter; left time: 6645.5700s
	iters: 600, epoch: 7 | loss: 0.0211878
	speed: 0.0282s/iter; left time: 6634.3994s
	iters: 700, epoch: 7 | loss: 0.0208638
	speed: 0.0282s/iter; left time: 6641.5859s
	iters: 800, epoch: 7 | loss: 0.0250263
	speed: 0.0282s/iter; left time: 6627.3642s
	iters: 900, epoch: 7 | loss: 0.0304753
	speed: 0.0283s/iter; left time: 6645.7857s
	iters: 1000, epoch: 7 | loss: 0.0162348
	speed: 0.0282s/iter; left time: 6634.2688s
	iters: 1100, epoch: 7 | loss: 0.0223022
	speed: 0.0281s/iter; left time: 6602.2454s
	iters: 1200, epoch: 7 | loss: 0.0174153
	speed: 0.0282s/iter; left time: 6621.5040s
	iters: 1300, epoch: 7 | loss: 0.0281757
	speed: 0.0283s/iter; left time: 6626.3119s
	iters: 1400, epoch: 7 | loss: 0.0175441
	speed: 0.0283s/iter; left time: 6628.4487s
	iters: 1500, epoch: 7 | loss: 0.0219345
	speed: 0.0283s/iter; left time: 6628.6603s
	iters: 1600, epoch: 7 | loss: 0.0274487
	speed: 0.0283s/iter; left time: 6618.5384s
	iters: 1700, epoch: 7 | loss: 0.0215970
	speed: 0.0282s/iter; left time: 6603.3645s
	iters: 1800, epoch: 7 | loss: 0.0218234
	speed: 0.0282s/iter; left time: 6606.9893s
	iters: 1900, epoch: 7 | loss: 0.0253773
	speed: 0.0283s/iter; left time: 6613.8365s
	iters: 2000, epoch: 7 | loss: 0.0161625
	speed: 0.0282s/iter; left time: 6603.7002s
	iters: 2100, epoch: 7 | loss: 0.0278843
	speed: 0.0282s/iter; left time: 6600.2387s
	iters: 2200, epoch: 7 | loss: 0.0178931
	speed: 0.0282s/iter; left time: 6593.3106s
	iters: 2300, epoch: 7 | loss: 0.0369865
	speed: 0.0282s/iter; left time: 6590.9297s
	iters: 2400, epoch: 7 | loss: 0.0330499
	speed: 0.0282s/iter; left time: 6588.8490s
	iters: 2500, epoch: 7 | loss: 0.0193679
	speed: 0.0282s/iter; left time: 6578.9788s
Epoch: 7 cost time: 70.84266591072083
Epoch: 7, Steps: 2509 | Train Loss: 0.0219753 Vali Loss: 0.0926012 Test Loss: 0.0161313
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.6329361175823677e-05
	iters: 100, epoch: 8 | loss: 0.0158249
	speed: 0.1534s/iter; left time: 35776.2695s
	iters: 200, epoch: 8 | loss: 0.0160492
	speed: 0.0282s/iter; left time: 6566.0860s
	iters: 300, epoch: 8 | loss: 0.0157045
	speed: 0.0283s/iter; left time: 6592.8128s
	iters: 400, epoch: 8 | loss: 0.0148424
	speed: 0.0282s/iter; left time: 6578.6853s
	iters: 500, epoch: 8 | loss: 0.0164215
	speed: 0.0282s/iter; left time: 6569.6798s
	iters: 600, epoch: 8 | loss: 0.0342113
	speed: 0.0283s/iter; left time: 6582.0522s
	iters: 700, epoch: 8 | loss: 0.0213536
	speed: 0.0282s/iter; left time: 6568.0479s
	iters: 800, epoch: 8 | loss: 0.0308943
	speed: 0.0283s/iter; left time: 6580.9771s
	iters: 900, epoch: 8 | loss: 0.0372163
	speed: 0.0282s/iter; left time: 6563.9513s
	iters: 1000, epoch: 8 | loss: 0.0229659
	speed: 0.0282s/iter; left time: 6559.1011s
	iters: 1100, epoch: 8 | loss: 0.0407690
	speed: 0.0282s/iter; left time: 6550.8905s
	iters: 1200, epoch: 8 | loss: 0.0196099
	speed: 0.0283s/iter; left time: 6576.5956s
	iters: 1300, epoch: 8 | loss: 0.0320840
	speed: 0.0283s/iter; left time: 6562.6063s
	iters: 1400, epoch: 8 | loss: 0.0181919
	speed: 0.0282s/iter; left time: 6549.4654s
	iters: 1500, epoch: 8 | loss: 0.0240386
	speed: 0.0283s/iter; left time: 6551.1675s
	iters: 1600, epoch: 8 | loss: 0.0326187
	speed: 0.0283s/iter; left time: 6547.6395s
	iters: 1700, epoch: 8 | loss: 0.0255277
	speed: 0.0283s/iter; left time: 6548.7545s
	iters: 1800, epoch: 8 | loss: 0.0391306
	speed: 0.0283s/iter; left time: 6552.9056s
	iters: 1900, epoch: 8 | loss: 0.0533884
	speed: 0.0283s/iter; left time: 6539.8546s
	iters: 2000, epoch: 8 | loss: 0.0194072
	speed: 0.0282s/iter; left time: 6534.0207s
	iters: 2100, epoch: 8 | loss: 0.0284317
	speed: 0.0282s/iter; left time: 6532.4234s
	iters: 2200, epoch: 8 | loss: 0.0202354
	speed: 0.0283s/iter; left time: 6538.0211s
	iters: 2300, epoch: 8 | loss: 0.0359730
	speed: 0.0282s/iter; left time: 6518.0994s
	iters: 2400, epoch: 8 | loss: 0.0349743
	speed: 0.0282s/iter; left time: 6521.1515s
	iters: 2500, epoch: 8 | loss: 0.0181754
	speed: 0.0282s/iter; left time: 6512.7443s
Epoch: 8 cost time: 70.86813068389893
Epoch: 8, Steps: 2509 | Train Loss: 0.0271789 Vali Loss: 0.0972691 Test Loss: 0.0166212
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.9882127921124198e-05
	iters: 100, epoch: 9 | loss: 0.0202340
	speed: 0.1534s/iter; left time: 35385.1467s
	iters: 200, epoch: 9 | loss: 0.0113628
	speed: 0.0282s/iter; left time: 6509.3094s
	iters: 300, epoch: 9 | loss: 0.0101042
	speed: 0.0282s/iter; left time: 6508.5970s
	iters: 400, epoch: 9 | loss: 0.0131992
	speed: 0.0282s/iter; left time: 6508.1811s
	iters: 500, epoch: 9 | loss: 0.0164560
	speed: 0.0282s/iter; left time: 6501.3227s
	iters: 600, epoch: 9 | loss: 0.0410762
	speed: 0.0282s/iter; left time: 6497.0460s
	iters: 700, epoch: 9 | loss: 0.0463862
	speed: 0.0282s/iter; left time: 6493.7642s
	iters: 800, epoch: 9 | loss: 0.0331097
	speed: 0.0282s/iter; left time: 6496.7783s
	iters: 900, epoch: 9 | loss: 0.0339017
	speed: 0.0283s/iter; left time: 6499.7237s
	iters: 1000, epoch: 9 | loss: 0.0233250
	speed: 0.0283s/iter; left time: 6495.2689s
	iters: 1100, epoch: 9 | loss: 0.0445569
	speed: 0.0283s/iter; left time: 6509.6816s
	iters: 1200, epoch: 9 | loss: 0.0315099
	speed: 0.0283s/iter; left time: 6493.7791s
	iters: 1300, epoch: 9 | loss: 0.0663345
	speed: 0.0283s/iter; left time: 6489.8397s
	iters: 1400, epoch: 9 | loss: 0.0188197
	speed: 0.0283s/iter; left time: 6484.4845s
	iters: 1500, epoch: 9 | loss: 0.0284976
	speed: 0.0282s/iter; left time: 6468.7414s
	iters: 1600, epoch: 9 | loss: 0.0344845
	speed: 0.0282s/iter; left time: 6466.6782s
	iters: 1700, epoch: 9 | loss: 0.0314925
	speed: 0.0282s/iter; left time: 6467.3567s
	iters: 1800, epoch: 9 | loss: 0.0324405
	speed: 0.0282s/iter; left time: 6459.5192s
	iters: 1900, epoch: 9 | loss: 0.0333859
	speed: 0.0283s/iter; left time: 6468.0041s
	iters: 2000, epoch: 9 | loss: 0.0243654
	speed: 0.0282s/iter; left time: 6460.1890s
	iters: 2100, epoch: 9 | loss: 0.0390391
	speed: 0.0283s/iter; left time: 6467.5161s
	iters: 2200, epoch: 9 | loss: 0.0256229
	speed: 0.0283s/iter; left time: 6469.4358s
	iters: 2300, epoch: 9 | loss: 0.0619746
	speed: 0.0283s/iter; left time: 6461.1314s
	iters: 2400, epoch: 9 | loss: 0.0445600
	speed: 0.0282s/iter; left time: 6452.3950s
	iters: 2500, epoch: 9 | loss: 0.0216852
	speed: 0.0283s/iter; left time: 6450.4305s
Epoch: 9 cost time: 70.85846257209778
Epoch: 9, Steps: 2509 | Train Loss: 0.0335921 Vali Loss: 0.0921046 Test Loss: 0.0165925
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : CBSU_36_48_PatchTST_CBSU_ftM_sl36_ll18_pl48_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_test_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
load CBSU ...
data shape:  (720, 4454) 4454
loading model.............
mse:0.01731022633612156, mae:0.06427176296710968, rse:0.4873778522014618
