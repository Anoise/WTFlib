Args in experiment:
Namespace(random_seed=2023, is_training=1, model_id='Milano_36_36', model='FEDformer', data='Milano_Call', root_path='../data_trfc/Milano/', n_part=24, features='M', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=36, pred_len=36, num_workers=10, itr=1, train_epochs=10, batch_size=128, patience=3, learning_rate=0.0001, weight_decay=0.0, des='test', loss='mse', lradj='type1', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False, max_diffusion_step=2, cl_decay_steps=2000, filter_type='dual_random_walk', num_rnn_layers=2, rnn_units=64, use_curriculum_learning=False, patch_len=2, stride=2, fc_dropout=0.05, head_dropout=0.0, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=416, dec_in=416, c_out=416, d_model=512, n_heads=8, e_layers=2, d_layers=1, d_ff=2048, moving_avg=25, factor=1, distil=True, dropout=0.05, embed='timeF', activation='gelu', output_attention=False, do_predict=False, version='Fourier', mode_select='random', modes=64, L=3, base='legendre', cross_activation='tanh', label_len=18)
Use GPU: cuda:0
fourier enhanced block used!
modes=64, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17]
fourier enhanced block used!
modes=64, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26]
 fourier enhanced cross attention used!
modes_q=27, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26]
modes_kv=18, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17]
enc_modes: 18, dec_modes: 27
>>>>>>>start training : Milano_36_36_FEDformer_Milano_Call_ftM_sl36_ll18_pl36_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_test_0>>>>>>>>>>>>>>>>>>>>>>>>>>
(300, 10000, 2) Call ...
data shape:  (300, 10000, 2) 10000
(10000, 10000) adj_max shape ...
(988, 10000, 2) Call ...
data shape:  (988, 10000, 2) 10000
(10000, 10000) adj_max shape ...
(200, 10000, 2) Call ...
data shape:  (200, 10000, 2) 10000
(10000, 10000) adj_max shape ...
	iters: 100, epoch: 1 | loss: 12.6321554
	speed: 0.1004s/iter; left time: 911.1339s
	iters: 200, epoch: 1 | loss: 10.6940231
	speed: 0.0983s/iter; left time: 881.4887s
	iters: 300, epoch: 1 | loss: 10.8284416
	speed: 0.0947s/iter; left time: 840.3769s
	iters: 400, epoch: 1 | loss: 8.8762941
	speed: 0.0866s/iter; left time: 759.8718s
	iters: 500, epoch: 1 | loss: 3.2340338
	speed: 0.1000s/iter; left time: 866.9973s
	iters: 600, epoch: 1 | loss: 7.4508615
	speed: 0.0997s/iter; left time: 854.7331s
	iters: 700, epoch: 1 | loss: 7.6863689
	speed: 0.0894s/iter; left time: 757.6070s
	iters: 800, epoch: 1 | loss: 4.8141160
	speed: 0.0954s/iter; left time: 798.3648s
	iters: 900, epoch: 1 | loss: 5.6239090
	speed: 0.0786s/iter; left time: 650.5030s
Epoch: 1 cost time: 85.66603183746338
Epoch: 1, Steps: 917 | Train Loss: 8.9174691 Vali Loss: 0.8657041 Test Loss: 0.8409883
Validation loss decreased (inf --> 0.865704).  Saving model ...
type1 => Adjust updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 6.3234935
	speed: 0.1512s/iter; left time: 1232.5210s
	iters: 200, epoch: 2 | loss: 8.3363638
	speed: 0.0680s/iter; left time: 547.8235s
	iters: 300, epoch: 2 | loss: 2.4770539
	speed: 0.0745s/iter; left time: 592.6232s
	iters: 400, epoch: 2 | loss: 5.8569160
	speed: 0.0793s/iter; left time: 622.9812s
	iters: 500, epoch: 2 | loss: 5.4190073
	speed: 0.0791s/iter; left time: 613.1932s
	iters: 600, epoch: 2 | loss: 3.1034083
	speed: 0.0794s/iter; left time: 607.7661s
	iters: 700, epoch: 2 | loss: 8.6204147
	speed: 0.0783s/iter; left time: 591.1255s
	iters: 800, epoch: 2 | loss: 1.8042710
	speed: 0.0788s/iter; left time: 587.5204s
	iters: 900, epoch: 2 | loss: 3.8544753
	speed: 0.0800s/iter; left time: 588.1328s
Epoch: 2 cost time: 71.79356908798218
Epoch: 2, Steps: 917 | Train Loss: 6.0548342 Vali Loss: 7.7810502 Test Loss: 7.5013208
EarlyStopping counter: 1 out of 3
type1 => Adjust updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 3.6329613
	speed: 0.1529s/iter; left time: 1106.8263s
	iters: 200, epoch: 3 | loss: 8.5749207
	speed: 0.0871s/iter; left time: 621.3227s
	iters: 300, epoch: 3 | loss: 1.8772771
	speed: 0.0862s/iter; left time: 606.7020s
	iters: 400, epoch: 3 | loss: 5.1208091
	speed: 0.0858s/iter; left time: 595.4676s
	iters: 500, epoch: 3 | loss: 7.1145501
	speed: 0.0869s/iter; left time: 594.0015s
	iters: 600, epoch: 3 | loss: 2.7755001
	speed: 0.0866s/iter; left time: 583.4105s
	iters: 700, epoch: 3 | loss: 7.0290222
	speed: 0.0864s/iter; left time: 573.7473s
	iters: 800, epoch: 3 | loss: 1.5706352
	speed: 0.0855s/iter; left time: 559.1690s
	iters: 900, epoch: 3 | loss: 5.6642280
	speed: 0.0863s/iter; left time: 555.4529s
Epoch: 3 cost time: 79.31420516967773
Epoch: 3, Steps: 917 | Train Loss: 5.9189224 Vali Loss: 5.2408533 Test Loss: 5.0174351
EarlyStopping counter: 2 out of 3
type1 => Adjust updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 5.6783462
	speed: 0.1529s/iter; left time: 966.2885s
	iters: 200, epoch: 4 | loss: 7.7708912
	speed: 0.0877s/iter; left time: 545.2097s
	iters: 300, epoch: 4 | loss: 2.1399407
	speed: 0.0896s/iter; left time: 548.1477s
	iters: 400, epoch: 4 | loss: 4.2205949
	speed: 0.0876s/iter; left time: 527.1132s
	iters: 500, epoch: 4 | loss: 6.4308500
	speed: 0.0866s/iter; left time: 512.5060s
	iters: 600, epoch: 4 | loss: 2.0488350
	speed: 0.0863s/iter; left time: 502.3340s
	iters: 700, epoch: 4 | loss: 4.5787334
	speed: 0.0941s/iter; left time: 537.9969s
	iters: 800, epoch: 4 | loss: 1.1045744
	speed: 0.0946s/iter; left time: 531.7660s
	iters: 900, epoch: 4 | loss: 4.4296012
	speed: 0.0949s/iter; left time: 523.7048s
Epoch: 4 cost time: 82.38997507095337
Epoch: 4, Steps: 917 | Train Loss: 5.3811421 Vali Loss: 4.6645889 Test Loss: 4.5181775
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : Milano_36_36_FEDformer_Milano_Call_ftM_sl36_ll18_pl36_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_test_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
(300, 10000, 2) Call ...
data shape:  (300, 10000, 2) 10000
(10000, 10000) adj_max shape ...
loading model.............
mse:0.8409876227378845, mae:0.5968375205993652, rse:2.7535674571990967
