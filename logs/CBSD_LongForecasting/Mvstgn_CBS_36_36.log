Args in experiment:
Namespace(random_seed=2023, is_training=1, model_id='CBS_36_36', model='Mvstgn', data='CBS', root_path='../data_trfc/CBS/', data_path='ETTh1.csv', n_part=24, features='M', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=36, pred_len=36, num_workers=10, itr=1, train_epochs=10, batch_size=128, patience=3, learning_rate=0.001, weight_decay=0.0001, des='test', loss='mse', lradj='Mvstgn', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False, max_diffusion_step=2, cl_decay_steps=2000, filter_type='dual_random_walk', num_rnn_layers=2, rnn_units=64, use_curriculum_learning=False, patch_len=2, stride=2, fc_dropout=0.05, head_dropout=0.0, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, label_len=4, embed_type=0, enc_in=552, dec_in=552, c_out=552, d_model=512, n_heads=8, e_layers=2, d_layers=1, d_ff=2048, moving_avg=25, factor=1, distil=True, dropout=0.05, embed='timeF', activation='gelu', output_attention=False, do_predict=False, version='Fourier', mode_select='random', modes=64, L=3, base='legendre', cross_activation='tanh')
Use GPU: cuda:0
>>>>>>>start training : CBS_36_36_Mvstgn_CBS_ftM_sl36_ll4_pl36_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_test_0>>>>>>>>>>>>>>>>>>>>>>>>>>
data shape:  (720, 4454) 4454
adj_mx shape:  (4454, 4454)
data shape:  (2592, 4454) 4454
adj_mx shape:  (4454, 4454)
data shape:  (720, 4454) 4454
adj_mx shape:  (4454, 4454)
	iters: 100, epoch: 1 | loss: 14.4452190
	speed: 0.0984s/iter; left time: 2471.7185s
	iters: 200, epoch: 1 | loss: 6.8489003
	speed: 0.0954s/iter; left time: 2387.0640s
	iters: 300, epoch: 1 | loss: 3.9528153
	speed: 0.0932s/iter; left time: 2321.0912s
	iters: 400, epoch: 1 | loss: 6.2973700
	speed: 0.0902s/iter; left time: 2237.2555s
	iters: 500, epoch: 1 | loss: 9.3525953
	speed: 0.0920s/iter; left time: 2273.4587s
	iters: 600, epoch: 1 | loss: 34.7313194
	speed: 0.0884s/iter; left time: 2174.7275s
	iters: 700, epoch: 1 | loss: 28.5124073
	speed: 0.0899s/iter; left time: 2204.5791s
	iters: 800, epoch: 1 | loss: 22.3349113
	speed: 0.0935s/iter; left time: 2282.5285s
	iters: 900, epoch: 1 | loss: 9.7787514
	speed: 0.0939s/iter; left time: 2281.6588s
	iters: 1000, epoch: 1 | loss: 17.9501286
	speed: 0.0960s/iter; left time: 2325.3798s
	iters: 1100, epoch: 1 | loss: 16.2200527
	speed: 0.1008s/iter; left time: 2429.4317s
	iters: 1200, epoch: 1 | loss: 18.7260990
	speed: 0.1047s/iter; left time: 2513.6634s
	iters: 1300, epoch: 1 | loss: 17.1047134
	speed: 0.1021s/iter; left time: 2441.6635s
	iters: 1400, epoch: 1 | loss: 4.8585706
	speed: 0.0979s/iter; left time: 2331.5429s
	iters: 1500, epoch: 1 | loss: 13.8035126
	speed: 0.0953s/iter; left time: 2259.2622s
	iters: 1600, epoch: 1 | loss: 13.9205523
	speed: 0.1087s/iter; left time: 2566.3002s
	iters: 1700, epoch: 1 | loss: 16.2179260
	speed: 0.1138s/iter; left time: 2674.6533s
	iters: 1800, epoch: 1 | loss: 16.5091763
	speed: 0.1012s/iter; left time: 2368.9926s
	iters: 1900, epoch: 1 | loss: 9.3941107
	speed: 0.0954s/iter; left time: 2223.8116s
	iters: 2000, epoch: 1 | loss: 7.9570107
	speed: 0.1009s/iter; left time: 2342.4360s
	iters: 2100, epoch: 1 | loss: 8.4392338
	speed: 0.1087s/iter; left time: 2512.0754s
	iters: 2200, epoch: 1 | loss: 16.6303215
	speed: 0.1080s/iter; left time: 2484.9809s
	iters: 2300, epoch: 1 | loss: 12.4892130
	speed: 0.1089s/iter; left time: 2495.6223s
	iters: 2400, epoch: 1 | loss: 14.1535263
	speed: 0.0932s/iter; left time: 2126.5734s
	iters: 2500, epoch: 1 | loss: 12.0454254
	speed: 0.0980s/iter; left time: 2226.2647s
Epoch: 1 cost time: 249.00293397903442
Epoch: 1, Steps: 2521 | Train Loss: 13.9065113 Vali Loss: 27.6517925 Test Loss: 3.7357414
Validation loss decreased (inf --> 27.651793).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 3.9770682
	speed: 0.3336s/iter; left time: 7536.1752s
	iters: 200, epoch: 2 | loss: 2.2281208
	speed: 0.1063s/iter; left time: 2390.9043s
	iters: 300, epoch: 2 | loss: 1.9173001
	speed: 0.0921s/iter; left time: 2063.1873s
	iters: 400, epoch: 2 | loss: 1.9858326
	speed: 0.0852s/iter; left time: 1899.0293s
	iters: 500, epoch: 2 | loss: 2.8372855
	speed: 0.0903s/iter; left time: 2003.2029s
	iters: 600, epoch: 2 | loss: 3.8641167
	speed: 0.0943s/iter; left time: 2083.0022s
	iters: 700, epoch: 2 | loss: 3.6255848
	speed: 0.0948s/iter; left time: 2084.4334s
	iters: 800, epoch: 2 | loss: 3.9297152
	speed: 0.1054s/iter; left time: 2307.5359s
	iters: 900, epoch: 2 | loss: 2.5728457
	speed: 0.0989s/iter; left time: 2154.6242s
	iters: 1000, epoch: 2 | loss: 2.8386717
	speed: 0.0935s/iter; left time: 2028.7269s
	iters: 1100, epoch: 2 | loss: 2.4850903
	speed: 0.0949s/iter; left time: 2049.2132s
	iters: 1200, epoch: 2 | loss: 3.3219759
	speed: 0.0936s/iter; left time: 2011.5069s
	iters: 1300, epoch: 2 | loss: 4.4873242
	speed: 0.0890s/iter; left time: 1903.2576s
	iters: 1400, epoch: 2 | loss: 1.7884197
	speed: 0.0946s/iter; left time: 2014.6982s
	iters: 1500, epoch: 2 | loss: 3.3439937
	speed: 0.0914s/iter; left time: 1937.2644s
	iters: 1600, epoch: 2 | loss: 2.9224739
	speed: 0.0966s/iter; left time: 2036.3794s
	iters: 1700, epoch: 2 | loss: 5.1019368
	speed: 0.0910s/iter; left time: 1910.9937s
	iters: 1800, epoch: 2 | loss: 5.2745843
	speed: 0.0993s/iter; left time: 2073.4427s
	iters: 1900, epoch: 2 | loss: 3.2848792
	speed: 0.1009s/iter; left time: 2097.7719s
	iters: 2000, epoch: 2 | loss: 4.1383743
	speed: 0.1014s/iter; left time: 2097.1425s
	iters: 2100, epoch: 2 | loss: 2.9936604
	speed: 0.0885s/iter; left time: 1822.3557s
	iters: 2200, epoch: 2 | loss: 2.8255701
	speed: 0.0917s/iter; left time: 1879.2808s
	iters: 2300, epoch: 2 | loss: 3.9987261
	speed: 0.0891s/iter; left time: 1817.2125s
	iters: 2400, epoch: 2 | loss: 3.0287831
	speed: 0.0949s/iter; left time: 1925.9651s
	iters: 2500, epoch: 2 | loss: 2.6099143
	speed: 0.0951s/iter; left time: 1920.2471s
Epoch: 2 cost time: 238.68500804901123
Epoch: 2, Steps: 2521 | Train Loss: 3.4652546 Vali Loss: 31.4015255 Test Loss: 2.8451457
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 3.6892922
	speed: 0.3397s/iter; left time: 6817.8297s
	iters: 200, epoch: 3 | loss: 1.8559295
	speed: 0.0980s/iter; left time: 1957.0403s
	iters: 300, epoch: 3 | loss: 1.3573177
	speed: 0.0982s/iter; left time: 1950.7301s
	iters: 400, epoch: 3 | loss: 3.6271019
	speed: 0.0985s/iter; left time: 1946.6444s
	iters: 500, epoch: 3 | loss: 4.1452527
	speed: 0.0986s/iter; left time: 1940.0893s
	iters: 600, epoch: 3 | loss: 18.4573212
	speed: 0.0956s/iter; left time: 1871.1707s
	iters: 700, epoch: 3 | loss: 9.0714273
	speed: 0.0985s/iter; left time: 1916.8334s
	iters: 800, epoch: 3 | loss: 8.6449871
	speed: 0.1150s/iter; left time: 2228.3212s
	iters: 900, epoch: 3 | loss: 4.0174704
	speed: 0.1060s/iter; left time: 2041.5990s
	iters: 1000, epoch: 3 | loss: 6.6547332
	speed: 0.1119s/iter; left time: 2144.1462s
	iters: 1100, epoch: 3 | loss: 9.7455492
	speed: 0.1043s/iter; left time: 1988.1197s
	iters: 1200, epoch: 3 | loss: 8.0734386
	speed: 0.0820s/iter; left time: 1554.9990s
	iters: 1300, epoch: 3 | loss: 6.2319283
	speed: 0.0932s/iter; left time: 1758.7047s
	iters: 1400, epoch: 3 | loss: 2.1988854
	speed: 0.0996s/iter; left time: 1868.9707s
	iters: 1500, epoch: 3 | loss: 7.4735651
	speed: 0.0919s/iter; left time: 1715.6196s
	iters: 1600, epoch: 3 | loss: 8.0479317
	speed: 0.0926s/iter; left time: 1718.6960s
	iters: 1700, epoch: 3 | loss: 11.4987898
	speed: 0.1039s/iter; left time: 1918.6221s
	iters: 1800, epoch: 3 | loss: 15.1898088
	speed: 0.0873s/iter; left time: 1603.2830s
	iters: 1900, epoch: 3 | loss: 10.8521080
	speed: 0.0918s/iter; left time: 1677.1740s
	iters: 2000, epoch: 3 | loss: 6.1679840
	speed: 0.0950s/iter; left time: 1725.8876s
	iters: 2100, epoch: 3 | loss: 8.8253803
	speed: 0.0965s/iter; left time: 1744.4208s
	iters: 2200, epoch: 3 | loss: 6.5499897
	speed: 0.0887s/iter; left time: 1593.5918s
	iters: 2300, epoch: 3 | loss: 17.8474770
	speed: 0.0949s/iter; left time: 1695.6506s
	iters: 2400, epoch: 3 | loss: 9.1961985
	speed: 0.0888s/iter; left time: 1578.3466s
	iters: 2500, epoch: 3 | loss: 8.7933998
	speed: 0.0858s/iter; left time: 1515.8124s
Epoch: 3 cost time: 242.57718300819397
Epoch: 3, Steps: 2521 | Train Loss: 7.4665513 Vali Loss: 22.4376163 Test Loss: 3.2958639
Validation loss decreased (27.651793 --> 22.437616).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 3.0986581
	speed: 0.2897s/iter; left time: 5083.2636s
	iters: 200, epoch: 4 | loss: 1.9467062
	speed: 0.0957s/iter; left time: 1669.0121s
	iters: 300, epoch: 4 | loss: 1.3260508
	speed: 0.0955s/iter; left time: 1656.6361s
	iters: 400, epoch: 4 | loss: 3.1215484
	speed: 0.1198s/iter; left time: 2066.8600s
	iters: 500, epoch: 4 | loss: 4.0613747
	speed: 0.0896s/iter; left time: 1536.3377s
	iters: 600, epoch: 4 | loss: 5.9638290
	speed: 0.0896s/iter; left time: 1527.9110s
	iters: 700, epoch: 4 | loss: 5.0401664
	speed: 0.0908s/iter; left time: 1538.4097s
	iters: 800, epoch: 4 | loss: 5.8644867
	speed: 0.1843s/iter; left time: 3104.7359s
	iters: 900, epoch: 4 | loss: 3.2960827
	speed: 0.1712s/iter; left time: 2867.3082s
	iters: 1000, epoch: 4 | loss: 3.0223551
	speed: 0.1080s/iter; left time: 1798.5329s
	iters: 1100, epoch: 4 | loss: 4.4960670
	speed: 0.1007s/iter; left time: 1667.0904s
	iters: 1200, epoch: 4 | loss: 3.7203915
	speed: 0.1252s/iter; left time: 2058.5059s
	iters: 1300, epoch: 4 | loss: 9.4843616
	speed: 0.1005s/iter; left time: 1642.3587s
	iters: 1400, epoch: 4 | loss: 1.8455727
	speed: 0.0967s/iter; left time: 1571.8071s
	iters: 1500, epoch: 4 | loss: 3.6466489
	speed: 0.1035s/iter; left time: 1671.3284s
	iters: 1600, epoch: 4 | loss: 4.0125113
	speed: 0.0967s/iter; left time: 1551.9047s
	iters: 1700, epoch: 4 | loss: 7.5905571
	speed: 0.1025s/iter; left time: 1634.7780s
	iters: 1800, epoch: 4 | loss: 6.3745904
	speed: 0.1183s/iter; left time: 1874.2359s
	iters: 1900, epoch: 4 | loss: 5.0395422
	speed: 0.1023s/iter; left time: 1611.2348s
	iters: 2000, epoch: 4 | loss: 2.8996358
	speed: 0.0927s/iter; left time: 1449.8727s
	iters: 2100, epoch: 4 | loss: 3.2794223
	speed: 0.1196s/iter; left time: 1860.2069s
	iters: 2200, epoch: 4 | loss: 4.4322119
	speed: 0.0959s/iter; left time: 1481.1027s
	iters: 2300, epoch: 4 | loss: 5.4305134
	speed: 0.0951s/iter; left time: 1459.5861s
	iters: 2400, epoch: 4 | loss: 5.0874243
	speed: 0.1021s/iter; left time: 1557.0099s
	iters: 2500, epoch: 4 | loss: 4.2302866
	speed: 0.0986s/iter; left time: 1494.3346s
Epoch: 4 cost time: 270.31740641593933
Epoch: 4, Steps: 2521 | Train Loss: 4.2990585 Vali Loss: 22.0784893 Test Loss: 2.7620690
Validation loss decreased (22.437616 --> 22.078489).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 5 | loss: 4.6971760
	speed: 0.3154s/iter; left time: 4739.6200s
	iters: 200, epoch: 5 | loss: 1.4691434
	speed: 0.0982s/iter; left time: 1466.3258s
	iters: 300, epoch: 5 | loss: 1.2491770
	speed: 0.1070s/iter; left time: 1586.7670s
	iters: 400, epoch: 5 | loss: 1.4873302
	speed: 0.1138s/iter; left time: 1676.3516s
	iters: 500, epoch: 5 | loss: 2.6953316
	speed: 0.1107s/iter; left time: 1619.7259s
	iters: 600, epoch: 5 | loss: 4.5253401
	speed: 0.1161s/iter; left time: 1686.0771s
	iters: 700, epoch: 5 | loss: 2.5372541
	speed: 0.1065s/iter; left time: 1536.3067s
	iters: 800, epoch: 5 | loss: 4.0835114
	speed: 0.1056s/iter; left time: 1512.9819s
	iters: 900, epoch: 5 | loss: 2.3379066
	speed: 0.1110s/iter; left time: 1579.7624s
	iters: 1000, epoch: 5 | loss: 2.6091511
	speed: 0.0946s/iter; left time: 1336.2854s
	iters: 1100, epoch: 5 | loss: 2.5393763
	speed: 0.0954s/iter; left time: 1338.1191s
	iters: 1200, epoch: 5 | loss: 2.8808141
	speed: 0.0893s/iter; left time: 1244.2351s
	iters: 1300, epoch: 5 | loss: 6.1483808
	speed: 0.0978s/iter; left time: 1352.4851s
	iters: 1400, epoch: 5 | loss: 1.5995567
	speed: 0.0861s/iter; left time: 1181.3822s
	iters: 1500, epoch: 5 | loss: 2.4355047
	speed: 0.0950s/iter; left time: 1294.9928s
	iters: 1600, epoch: 5 | loss: 2.5991764
	speed: 0.0956s/iter; left time: 1293.2029s
	iters: 1700, epoch: 5 | loss: 4.4840546
	speed: 0.0952s/iter; left time: 1278.8230s
	iters: 1800, epoch: 5 | loss: 4.0917120
	speed: 0.0977s/iter; left time: 1301.4345s
	iters: 1900, epoch: 5 | loss: 2.5961578
	speed: 0.0877s/iter; left time: 1160.1181s
	iters: 2000, epoch: 5 | loss: 2.2640440
	speed: 0.0936s/iter; left time: 1229.2669s
	iters: 2100, epoch: 5 | loss: 2.4737477
	speed: 0.0918s/iter; left time: 1195.4618s
	iters: 2200, epoch: 5 | loss: 2.1745598
	speed: 0.0938s/iter; left time: 1212.9486s
	iters: 2300, epoch: 5 | loss: 4.0172949
	speed: 0.1118s/iter; left time: 1434.6540s
	iters: 2400, epoch: 5 | loss: 3.1896985
	speed: 0.0914s/iter; left time: 1163.6024s
	iters: 2500, epoch: 5 | loss: 2.0303547
	speed: 0.0889s/iter; left time: 1122.9768s
Epoch: 5 cost time: 249.63580465316772
Epoch: 5, Steps: 2521 | Train Loss: 2.9410778 Vali Loss: 22.4011765 Test Loss: 2.3576875
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.0001
	iters: 100, epoch: 6 | loss: 3.4316373
	speed: 0.3206s/iter; left time: 4009.6828s
	iters: 200, epoch: 6 | loss: 1.4944332
	speed: 0.1078s/iter; left time: 1337.0925s
	iters: 300, epoch: 6 | loss: 1.7520579
	speed: 0.0985s/iter; left time: 1212.1408s
	iters: 400, epoch: 6 | loss: 3.6508114
	speed: 0.0987s/iter; left time: 1204.7340s
	iters: 500, epoch: 6 | loss: 5.0164685
	speed: 0.0956s/iter; left time: 1157.7718s
	iters: 600, epoch: 6 | loss: 6.5221462
	speed: 0.0955s/iter; left time: 1146.6710s
	iters: 700, epoch: 6 | loss: 4.6131005
	speed: 0.0957s/iter; left time: 1139.2257s
	iters: 800, epoch: 6 | loss: 4.6024513
	speed: 0.0962s/iter; left time: 1135.3377s
	iters: 900, epoch: 6 | loss: 4.3788066
	speed: 0.0985s/iter; left time: 1153.0204s
	iters: 1000, epoch: 6 | loss: 4.4875917
	speed: 0.0955s/iter; left time: 1108.2286s
	iters: 1100, epoch: 6 | loss: 11.5038853
	speed: 0.0897s/iter; left time: 1031.7672s
	iters: 1200, epoch: 6 | loss: 4.5012817
	speed: 0.0953s/iter; left time: 1087.2934s
	iters: 1300, epoch: 6 | loss: 9.9660635
	speed: 0.1004s/iter; left time: 1135.5440s
	iters: 1400, epoch: 6 | loss: 1.5913140
	speed: 0.0937s/iter; left time: 1049.5049s
	iters: 1500, epoch: 6 | loss: 3.7355809
	speed: 0.0914s/iter; left time: 1015.0652s
	iters: 1600, epoch: 6 | loss: 7.8785610
	speed: 0.0940s/iter; left time: 1034.9020s
	iters: 1700, epoch: 6 | loss: 10.2625790
	speed: 0.0940s/iter; left time: 1025.4672s
	iters: 1800, epoch: 6 | loss: 8.8585730
	speed: 0.0920s/iter; left time: 993.6593s
	iters: 1900, epoch: 6 | loss: 10.7688360
	speed: 0.0974s/iter; left time: 1043.2706s
	iters: 2000, epoch: 6 | loss: 3.9787271
	speed: 0.0917s/iter; left time: 972.1224s
	iters: 2100, epoch: 6 | loss: 8.2020550
	speed: 0.0961s/iter; left time: 1009.8933s
	iters: 2200, epoch: 6 | loss: 4.2316599
	speed: 0.1153s/iter; left time: 1200.0807s
	iters: 2300, epoch: 6 | loss: 9.3519964
	speed: 0.1195s/iter; left time: 1232.0279s
	iters: 2400, epoch: 6 | loss: 10.0369844
	speed: 0.1057s/iter; left time: 1078.8227s
	iters: 2500, epoch: 6 | loss: 3.3354096
	speed: 0.1275s/iter; left time: 1288.4317s
Epoch: 6 cost time: 250.4289677143097
Epoch: 6, Steps: 2521 | Train Loss: 5.5955882 Vali Loss: 18.9495354 Test Loss: 2.3805265
Validation loss decreased (22.078489 --> 18.949535).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 7 | loss: 2.9909680
	speed: 0.3005s/iter; left time: 3000.4389s
	iters: 200, epoch: 7 | loss: 1.2472386
	speed: 0.1287s/iter; left time: 1272.6252s
	iters: 300, epoch: 7 | loss: 1.1714681
	speed: 0.0969s/iter; left time: 947.9931s
	iters: 400, epoch: 7 | loss: 1.1940331
	speed: 0.0929s/iter; left time: 899.6086s
	iters: 500, epoch: 7 | loss: 1.7707423
	speed: 0.1000s/iter; left time: 958.3576s
	iters: 600, epoch: 7 | loss: 3.4165168
	speed: 0.0840s/iter; left time: 796.4271s
	iters: 700, epoch: 7 | loss: 3.5856376
	speed: 0.0907s/iter; left time: 850.9961s
	iters: 800, epoch: 7 | loss: 3.5951941
	speed: 0.0948s/iter; left time: 880.0887s
	iters: 900, epoch: 7 | loss: 2.7055326
	speed: 0.0933s/iter; left time: 857.2819s
	iters: 1000, epoch: 7 | loss: 2.3001657
	speed: 0.0978s/iter; left time: 888.4213s
	iters: 1100, epoch: 7 | loss: 3.0812020
	speed: 0.1009s/iter; left time: 906.4191s
	iters: 1200, epoch: 7 | loss: 3.3989341
	speed: 0.1034s/iter; left time: 918.9807s
	iters: 1300, epoch: 7 | loss: 4.7398958
	speed: 0.0933s/iter; left time: 819.6264s
	iters: 1400, epoch: 7 | loss: 1.4128925
	speed: 0.0920s/iter; left time: 799.0868s
	iters: 1500, epoch: 7 | loss: 2.7358866
	speed: 0.1011s/iter; left time: 867.8931s
	iters: 1600, epoch: 7 | loss: 4.1581364
	speed: 0.0973s/iter; left time: 825.3039s
	iters: 1700, epoch: 7 | loss: 4.5059171
	speed: 0.1034s/iter; left time: 866.8122s
	iters: 1800, epoch: 7 | loss: 5.1465502
	speed: 0.1258s/iter; left time: 1042.3752s
	iters: 1900, epoch: 7 | loss: 3.6903493
	speed: 0.0900s/iter; left time: 736.4079s
	iters: 2000, epoch: 7 | loss: 2.3263876
	speed: 0.0954s/iter; left time: 771.6281s
	iters: 2100, epoch: 7 | loss: 3.8186245
	speed: 0.0945s/iter; left time: 754.7245s
	iters: 2200, epoch: 7 | loss: 2.4434836
	speed: 0.0959s/iter; left time: 755.8457s
	iters: 2300, epoch: 7 | loss: 6.3879633
	speed: 0.0993s/iter; left time: 772.8873s
	iters: 2400, epoch: 7 | loss: 4.8199234
	speed: 0.1124s/iter; left time: 864.1290s
	iters: 2500, epoch: 7 | loss: 2.7075732
	speed: 0.1025s/iter; left time: 777.7300s
Epoch: 7 cost time: 250.3869867324829
Epoch: 7, Steps: 2521 | Train Loss: 3.1706964 Vali Loss: 19.0241604 Test Loss: 2.2524571
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.0001
	iters: 100, epoch: 8 | loss: 2.4654057
	speed: 0.3333s/iter; left time: 2487.4077s
	iters: 200, epoch: 8 | loss: 1.1567045
	speed: 0.1125s/iter; left time: 828.6123s
	iters: 300, epoch: 8 | loss: 0.9970982
	speed: 0.1088s/iter; left time: 790.4883s
	iters: 400, epoch: 8 | loss: 2.2255800
	speed: 0.0899s/iter; left time: 643.9349s
	iters: 500, epoch: 8 | loss: 1.8555366
	speed: 0.1040s/iter; left time: 734.8819s
	iters: 600, epoch: 8 | loss: 10.7416410
	speed: 0.0943s/iter; left time: 656.4595s
	iters: 700, epoch: 8 | loss: 4.5945225
	speed: 0.0915s/iter; left time: 628.3908s
	iters: 800, epoch: 8 | loss: 5.4360642
	speed: 0.0974s/iter; left time: 658.9340s
	iters: 900, epoch: 8 | loss: 3.8240900
	speed: 0.0947s/iter; left time: 630.9550s
	iters: 1000, epoch: 8 | loss: 5.0713787
	speed: 0.0892s/iter; left time: 585.4961s
	iters: 1100, epoch: 8 | loss: 7.4275799
	speed: 0.1000s/iter; left time: 646.3563s
	iters: 1200, epoch: 8 | loss: 4.2134209
	speed: 0.0904s/iter; left time: 575.4695s
	iters: 1300, epoch: 8 | loss: 6.4259830
	speed: 0.1056s/iter; left time: 661.4827s
	iters: 1400, epoch: 8 | loss: 1.5837665
	speed: 0.1145s/iter; left time: 705.8836s
	iters: 1500, epoch: 8 | loss: 4.3478236
	speed: 0.0951s/iter; left time: 576.7787s
	iters: 1600, epoch: 8 | loss: 7.5575032
	speed: 0.0842s/iter; left time: 502.1570s
	iters: 1700, epoch: 8 | loss: 9.3534069
	speed: 0.0921s/iter; left time: 539.8087s
	iters: 1800, epoch: 8 | loss: 8.9414368
	speed: 0.0947s/iter; left time: 545.7934s
	iters: 1900, epoch: 8 | loss: 6.2780828
	speed: 0.1028s/iter; left time: 582.0430s
	iters: 2000, epoch: 8 | loss: 4.0124483
	speed: 0.1349s/iter; left time: 750.7033s
	iters: 2100, epoch: 8 | loss: 4.5371680
	speed: 0.1136s/iter; left time: 620.9105s
	iters: 2200, epoch: 8 | loss: 3.3400323
	speed: 0.1061s/iter; left time: 569.3055s
	iters: 2300, epoch: 8 | loss: 11.8384438
	speed: 0.1169s/iter; left time: 615.3598s
	iters: 2400, epoch: 8 | loss: 7.4506173
	speed: 0.0981s/iter; left time: 506.4167s
	iters: 2500, epoch: 8 | loss: 4.4191508
	speed: 0.0950s/iter; left time: 481.0233s
Epoch: 8 cost time: 254.68625259399414
Epoch: 8, Steps: 2521 | Train Loss: 4.8093389 Vali Loss: 18.1764050 Test Loss: 2.6852264
Validation loss decreased (18.949535 --> 18.176405).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 9 | loss: 3.9688804
	speed: 0.3547s/iter; left time: 1753.3302s
	iters: 200, epoch: 9 | loss: 1.2273434
	speed: 0.1114s/iter; left time: 539.3006s
	iters: 300, epoch: 9 | loss: 0.9013248
	speed: 0.0958s/iter; left time: 454.5283s
	iters: 400, epoch: 9 | loss: 1.6060641
	speed: 0.0937s/iter; left time: 435.0035s
	iters: 500, epoch: 9 | loss: 2.7867227
	speed: 0.0910s/iter; left time: 413.4941s
	iters: 600, epoch: 9 | loss: 3.7095599
	speed: 0.0929s/iter; left time: 412.9435s
	iters: 700, epoch: 9 | loss: 8.4706020
	speed: 0.0920s/iter; left time: 399.5331s
	iters: 800, epoch: 9 | loss: 4.8598013
	speed: 0.1000s/iter; left time: 424.1202s
	iters: 900, epoch: 9 | loss: 3.2665360
	speed: 0.0948s/iter; left time: 392.6999s
	iters: 1000, epoch: 9 | loss: 4.1283693
	speed: 0.0936s/iter; left time: 378.2248s
	iters: 1100, epoch: 9 | loss: 5.7304597
	speed: 0.0930s/iter; left time: 366.5058s
	iters: 1200, epoch: 9 | loss: 3.3502183
	speed: 0.0932s/iter; left time: 358.2728s
	iters: 1300, epoch: 9 | loss: 10.0931425
	speed: 0.0982s/iter; left time: 367.4378s
	iters: 1400, epoch: 9 | loss: 1.6556578
	speed: 0.0889s/iter; left time: 323.7481s
	iters: 1500, epoch: 9 | loss: 4.6616445
	speed: 0.0945s/iter; left time: 334.6686s
	iters: 1600, epoch: 9 | loss: 5.7662878
	speed: 0.0841s/iter; left time: 289.7100s
	iters: 1700, epoch: 9 | loss: 8.0941610
	speed: 0.1005s/iter; left time: 336.0926s
	iters: 1800, epoch: 9 | loss: 6.0626316
	speed: 0.1067s/iter; left time: 346.1438s
	iters: 1900, epoch: 9 | loss: 4.7326279
	speed: 0.0880s/iter; left time: 276.4359s
	iters: 2000, epoch: 9 | loss: 2.8763151
	speed: 0.0903s/iter; left time: 274.6972s
	iters: 2100, epoch: 9 | loss: 3.2010405
	speed: 0.1003s/iter; left time: 295.2442s
	iters: 2200, epoch: 9 | loss: 2.5128303
	speed: 0.0973s/iter; left time: 276.6482s
	iters: 2300, epoch: 9 | loss: 8.2038145
	speed: 0.0982s/iter; left time: 269.4261s
	iters: 2400, epoch: 9 | loss: 4.7289948
	speed: 0.1085s/iter; left time: 286.7546s
	iters: 2500, epoch: 9 | loss: 3.4175906
	speed: 0.1243s/iter; left time: 316.2096s
Epoch: 9 cost time: 246.0485692024231
Epoch: 9, Steps: 2521 | Train Loss: 4.4850636 Vali Loss: 18.5798492 Test Loss: 2.1273582
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.0001
	iters: 100, epoch: 10 | loss: 6.5912151
	speed: 0.3270s/iter; left time: 791.9916s
	iters: 200, epoch: 10 | loss: 2.1258903
	speed: 0.0916s/iter; left time: 212.6949s
	iters: 300, epoch: 10 | loss: 1.6645094
	speed: 0.0878s/iter; left time: 195.1768s
	iters: 400, epoch: 10 | loss: 4.4312968
	speed: 0.0865s/iter; left time: 183.6238s
	iters: 500, epoch: 10 | loss: 5.2283554
	speed: 0.0877s/iter; left time: 177.2511s
	iters: 600, epoch: 10 | loss: 19.3003292
	speed: 0.0927s/iter; left time: 178.1913s
	iters: 700, epoch: 10 | loss: 7.0723958
	speed: 0.0926s/iter; left time: 168.6594s
	iters: 800, epoch: 10 | loss: 8.4847727
	speed: 0.0943s/iter; left time: 162.4030s
	iters: 900, epoch: 10 | loss: 5.5486159
	speed: 0.0979s/iter; left time: 158.8725s
	iters: 1000, epoch: 10 | loss: 4.9941068
	speed: 0.1040s/iter; left time: 158.2200s
	iters: 1100, epoch: 10 | loss: 12.0999861
	speed: 0.0938s/iter; left time: 133.3473s
	iters: 1200, epoch: 10 | loss: 10.6413364
	speed: 0.0913s/iter; left time: 120.6644s
	iters: 1300, epoch: 10 | loss: 12.9892225
	speed: 0.0951s/iter; left time: 116.2155s
	iters: 1400, epoch: 10 | loss: 2.2567933
	speed: 0.0909s/iter; left time: 102.0312s
	iters: 1500, epoch: 10 | loss: 5.5889864
	speed: 0.0937s/iter; left time: 95.7212s
	iters: 1600, epoch: 10 | loss: 11.1219234
	speed: 0.0913s/iter; left time: 84.2014s
	iters: 1700, epoch: 10 | loss: 13.6092606
	speed: 0.0998s/iter; left time: 82.0169s
	iters: 1800, epoch: 10 | loss: 12.7220831
	speed: 0.0936s/iter; left time: 67.5664s
	iters: 1900, epoch: 10 | loss: 11.5773115
	speed: 0.0971s/iter; left time: 60.3938s
	iters: 2000, epoch: 10 | loss: 5.4359260
	speed: 0.0938s/iter; left time: 48.9689s
	iters: 2100, epoch: 10 | loss: 9.9465370
	speed: 0.0976s/iter; left time: 41.1857s
	iters: 2200, epoch: 10 | loss: 5.1287470
	speed: 0.0898s/iter; left time: 28.9094s
	iters: 2300, epoch: 10 | loss: 16.6132526
	speed: 0.0948s/iter; left time: 21.0486s
	iters: 2400, epoch: 10 | loss: 12.4173498
	speed: 0.0892s/iter; left time: 10.8866s
	iters: 2500, epoch: 10 | loss: 6.8140473
	speed: 0.0904s/iter; left time: 1.9895s
Epoch: 10 cost time: 235.07393383979797
Epoch: 10, Steps: 2521 | Train Loss: 8.1505050 Vali Loss: 17.0227070 Test Loss: 2.4420147
Validation loss decreased (18.176405 --> 17.022707).  Saving model ...
Updating learning rate to 0.0001
>>>>>>>testing : CBS_36_36_Mvstgn_CBS_ftM_sl36_ll4_pl36_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_test_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
data shape:  (720, 4454) 4454
adj_mx shape:  (4454, 4454)
loading model.............
mse:2.4420154094696045, mae:0.7827437520027161, rse:0.47297507524490356
