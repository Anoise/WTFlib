Args in experiment:
Namespace(random_seed=2023, is_training=1, model_id='CBS_36_72', model='FEDformer', data='CBS', root_path='../data_trfc/CBS/', data_path='ETTh1.csv', n_part=24, features='M', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=36, pred_len=72, num_workers=10, itr=1, train_epochs=10, batch_size=128, patience=10, learning_rate=0.0001, weight_decay=0.0, des='test', loss='mse', lradj='type1', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False, max_diffusion_step=2, cl_decay_steps=2000, filter_type='dual_random_walk', num_rnn_layers=2, rnn_units=64, use_curriculum_learning=False, patch_len=2, stride=2, fc_dropout=0.05, head_dropout=0.0, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, label_len=4, embed_type=0, enc_in=185, dec_in=185, c_out=185, d_model=512, n_heads=8, e_layers=2, d_layers=1, d_ff=2048, moving_avg=25, factor=1, distil=True, dropout=0.05, embed='timeF', activation='gelu', output_attention=False, do_predict=False, version='Fourier', mode_select='random', modes=64, L=3, base='legendre', cross_activation='tanh')
Use GPU: cuda:0
fourier enhanced block used!
modes=64, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17]
fourier enhanced block used!
modes=64, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44]
 fourier enhanced cross attention used!
modes_q=45, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44]
modes_kv=18, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17]
enc_modes: 18, dec_modes: 45
>>>>>>>start training : CBS_36_72_FEDformer_CBS_ftM_sl36_ll4_pl72_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_test_0>>>>>>>>>>>>>>>>>>>>>>>>>>
data shape:  (720, 4454) 4454
data shape:  (2592, 4454) 4454
data shape:  (720, 4454) 4454
	iters: 100, epoch: 1 | loss: 6.0782180
	speed: 0.0807s/iter; left time: 1997.4331s
	iters: 200, epoch: 1 | loss: 4.9582081
	speed: 0.0883s/iter; left time: 2175.9422s
	iters: 300, epoch: 1 | loss: 5.1267638
	speed: 0.0877s/iter; left time: 2152.1270s
	iters: 400, epoch: 1 | loss: 5.7682958
	speed: 0.0899s/iter; left time: 2197.0553s
	iters: 500, epoch: 1 | loss: 13.4912872
	speed: 0.0930s/iter; left time: 2263.7638s
	iters: 600, epoch: 1 | loss: 28.6215477
	speed: 0.0932s/iter; left time: 2260.7111s
	iters: 700, epoch: 1 | loss: 24.5928631
	speed: 0.0947s/iter; left time: 2286.5828s
	iters: 800, epoch: 1 | loss: 24.8850822
	speed: 0.1058s/iter; left time: 2543.5446s
	iters: 900, epoch: 1 | loss: 21.7218685
	speed: 0.0909s/iter; left time: 2176.9261s
	iters: 1000, epoch: 1 | loss: 22.1463032
	speed: 0.1028s/iter; left time: 2452.6101s
	iters: 1100, epoch: 1 | loss: 20.8330936
	speed: 0.1136s/iter; left time: 2699.2346s
	iters: 1200, epoch: 1 | loss: 26.6165485
	speed: 0.0872s/iter; left time: 2062.7465s
	iters: 1300, epoch: 1 | loss: 18.2091904
	speed: 0.0761s/iter; left time: 1792.1436s
	iters: 1400, epoch: 1 | loss: 6.9429116
	speed: 0.0870s/iter; left time: 2039.2007s
	iters: 1500, epoch: 1 | loss: 22.9678822
	speed: 0.0969s/iter; left time: 2263.4487s
	iters: 1600, epoch: 1 | loss: 23.0453854
	speed: 0.1000s/iter; left time: 2323.9904s
	iters: 1700, epoch: 1 | loss: 26.2461147
	speed: 0.0935s/iter; left time: 2165.3723s
	iters: 1800, epoch: 1 | loss: 24.3662453
	speed: 0.0917s/iter; left time: 2112.8056s
	iters: 1900, epoch: 1 | loss: 20.7816124
	speed: 0.0844s/iter; left time: 1936.6333s
	iters: 2000, epoch: 1 | loss: 20.6707954
	speed: 0.0773s/iter; left time: 1765.7821s
	iters: 2100, epoch: 1 | loss: 21.1141090
	speed: 0.0834s/iter; left time: 1897.1576s
	iters: 2200, epoch: 1 | loss: 21.5326862
	speed: 0.0875s/iter; left time: 1981.7158s
	iters: 2300, epoch: 1 | loss: 22.8151150
	speed: 0.0878s/iter; left time: 1980.4004s
	iters: 2400, epoch: 1 | loss: 20.4203968
	speed: 0.0813s/iter; left time: 1825.3271s
Epoch: 1 cost time: 224.20040035247803
Epoch: 1, Steps: 2485 | Train Loss: 19.1170145 Vali Loss: 41.9094162 Test Loss: 7.4279847
Validation loss decreased (inf --> 41.909416).  Saving model ...
type1 => Adjust updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 4.9511061
	speed: 0.3681s/iter; left time: 8195.2861s
	iters: 200, epoch: 2 | loss: 2.5917530
	speed: 0.0845s/iter; left time: 1873.2615s
	iters: 300, epoch: 2 | loss: 1.8700119
	speed: 0.0891s/iter; left time: 1965.6864s
	iters: 400, epoch: 2 | loss: 5.2501426
	speed: 0.0960s/iter; left time: 2108.5411s
	iters: 500, epoch: 2 | loss: 6.2569761
	speed: 0.0874s/iter; left time: 1910.6412s
	iters: 600, epoch: 2 | loss: 11.1757603
	speed: 0.0850s/iter; left time: 1850.4700s
	iters: 700, epoch: 2 | loss: 8.6617212
	speed: 0.0874s/iter; left time: 1893.2661s
	iters: 800, epoch: 2 | loss: 8.2883825
	speed: 0.0924s/iter; left time: 1991.8916s
	iters: 900, epoch: 2 | loss: 7.2161646
	speed: 0.0988s/iter; left time: 2120.7249s
	iters: 1000, epoch: 2 | loss: 4.7944908
	speed: 0.1002s/iter; left time: 2140.6850s
	iters: 1100, epoch: 2 | loss: 7.5000730
	speed: 0.1038s/iter; left time: 2208.3273s
	iters: 1200, epoch: 2 | loss: 5.5707126
	speed: 0.1062s/iter; left time: 2248.7202s
	iters: 1300, epoch: 2 | loss: 5.1854343
	speed: 0.1067s/iter; left time: 2248.1369s
	iters: 1400, epoch: 2 | loss: 3.5176723
	speed: 0.1016s/iter; left time: 2130.1335s
	iters: 1500, epoch: 2 | loss: 5.5899296
	speed: 0.0891s/iter; left time: 1858.3506s
	iters: 1600, epoch: 2 | loss: 7.0165343
	speed: 0.0832s/iter; left time: 1727.9955s
	iters: 1700, epoch: 2 | loss: 9.9619303
	speed: 0.0865s/iter; left time: 1787.7164s
	iters: 1800, epoch: 2 | loss: 8.8049450
	speed: 0.0934s/iter; left time: 1921.0964s
	iters: 1900, epoch: 2 | loss: 7.9453502
	speed: 0.0805s/iter; left time: 1647.2661s
	iters: 2000, epoch: 2 | loss: 4.9788890
	speed: 0.0826s/iter; left time: 1683.2439s
	iters: 2100, epoch: 2 | loss: 8.0805044
	speed: 0.0873s/iter; left time: 1769.1517s
	iters: 2200, epoch: 2 | loss: 5.5204206
	speed: 0.0880s/iter; left time: 1775.5711s
	iters: 2300, epoch: 2 | loss: 10.5283127
	speed: 0.0899s/iter; left time: 1804.4633s
	iters: 2400, epoch: 2 | loss: 7.1679349
	speed: 0.1016s/iter; left time: 2029.3779s
Epoch: 2 cost time: 228.67741870880127
Epoch: 2, Steps: 2485 | Train Loss: 6.4773021 Vali Loss: 52.4141502 Test Loss: 15.5612354
EarlyStopping counter: 1 out of 10
type1 => Adjust updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 4.3260312
	speed: 0.3714s/iter; left time: 7345.9738s
	iters: 200, epoch: 3 | loss: 2.6977589
	speed: 0.0849s/iter; left time: 1671.2334s
	iters: 300, epoch: 3 | loss: 2.2926643
	speed: 0.0858s/iter; left time: 1679.8633s
	iters: 400, epoch: 3 | loss: 2.8265207
	speed: 0.0828s/iter; left time: 1613.4886s
	iters: 500, epoch: 3 | loss: 6.7100935
	speed: 0.0891s/iter; left time: 1727.1088s
	iters: 600, epoch: 3 | loss: 13.6703949
	speed: 0.0865s/iter; left time: 1667.5743s
	iters: 700, epoch: 3 | loss: 10.3023520
	speed: 0.0819s/iter; left time: 1570.5890s
	iters: 800, epoch: 3 | loss: 14.3377161
	speed: 0.0902s/iter; left time: 1720.7860s
	iters: 900, epoch: 3 | loss: 11.7655058
	speed: 0.0954s/iter; left time: 1810.3690s
	iters: 1000, epoch: 3 | loss: 8.4352951
	speed: 0.0970s/iter; left time: 1830.7657s
	iters: 1100, epoch: 3 | loss: 10.5571899
	speed: 0.0938s/iter; left time: 1761.1353s
	iters: 1200, epoch: 3 | loss: 10.9676380
	speed: 0.0924s/iter; left time: 1725.4484s
	iters: 1300, epoch: 3 | loss: 8.8219395
	speed: 0.0917s/iter; left time: 1703.5324s
	iters: 1400, epoch: 3 | loss: 4.6652122
	speed: 0.1035s/iter; left time: 1912.8389s
	iters: 1500, epoch: 3 | loss: 10.1727877
	speed: 0.1103s/iter; left time: 2027.2366s
	iters: 1600, epoch: 3 | loss: 11.0217991
	speed: 0.1080s/iter; left time: 1975.1316s
	iters: 1700, epoch: 3 | loss: 11.1251631
	speed: 0.0965s/iter; left time: 1755.0089s
	iters: 1800, epoch: 3 | loss: 11.1039743
	speed: 0.0921s/iter; left time: 1666.1298s
	iters: 1900, epoch: 3 | loss: 11.2993746
	speed: 0.0988s/iter; left time: 1776.8068s
	iters: 2000, epoch: 3 | loss: 6.1093659
	speed: 0.0880s/iter; left time: 1572.9738s
	iters: 2100, epoch: 3 | loss: 11.8302698
	speed: 0.0904s/iter; left time: 1606.7038s
	iters: 2200, epoch: 3 | loss: 8.8221540
	speed: 0.0904s/iter; left time: 1597.9721s
	iters: 2300, epoch: 3 | loss: 14.5790882
	speed: 0.0865s/iter; left time: 1521.1687s
	iters: 2400, epoch: 3 | loss: 7.5417943
	speed: 0.0892s/iter; left time: 1558.7377s
Epoch: 3 cost time: 227.81560349464417
Epoch: 3, Steps: 2485 | Train Loss: 9.1034497 Vali Loss: 52.6417351 Test Loss: 16.0954094
EarlyStopping counter: 2 out of 10
type1 => Adjust updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 8.3754072
	speed: 0.3916s/iter; left time: 6773.7896s
	iters: 200, epoch: 4 | loss: 3.6108227
	speed: 0.1028s/iter; left time: 1768.1011s
	iters: 300, epoch: 4 | loss: 3.4644465
	speed: 0.0953s/iter; left time: 1629.2090s
	iters: 400, epoch: 4 | loss: 6.1548367
	speed: 0.1019s/iter; left time: 1731.2569s
	iters: 500, epoch: 4 | loss: 3.2836835
	speed: 0.1120s/iter; left time: 1891.7574s
	iters: 600, epoch: 4 | loss: 3.9579546
	speed: 0.0925s/iter; left time: 1553.8152s
	iters: 700, epoch: 4 | loss: 6.8546400
	speed: 0.0948s/iter; left time: 1583.2735s
	iters: 800, epoch: 4 | loss: 12.4738169
	speed: 0.0940s/iter; left time: 1560.0787s
	iters: 900, epoch: 4 | loss: 6.7297263
	speed: 0.0933s/iter; left time: 1539.4737s
	iters: 1000, epoch: 4 | loss: 4.6813722
	speed: 0.0882s/iter; left time: 1445.5219s
	iters: 1100, epoch: 4 | loss: 4.0319114
	speed: 0.0835s/iter; left time: 1360.4079s
	iters: 1200, epoch: 4 | loss: 4.0909743
	speed: 0.0843s/iter; left time: 1365.9421s
	iters: 1300, epoch: 4 | loss: 5.7994299
	speed: 0.0917s/iter; left time: 1476.7042s
	iters: 1400, epoch: 4 | loss: 2.9431055
	speed: 0.0875s/iter; left time: 1399.6568s
	iters: 1500, epoch: 4 | loss: 4.4705667
	speed: 0.0936s/iter; left time: 1488.1106s
	iters: 1600, epoch: 4 | loss: 3.9150832
	speed: 0.1106s/iter; left time: 1746.3657s
	iters: 1700, epoch: 4 | loss: 5.5850210
	speed: 0.0969s/iter; left time: 1520.4734s
	iters: 1800, epoch: 4 | loss: 4.5376511
	speed: 0.0964s/iter; left time: 1504.1264s
	iters: 1900, epoch: 4 | loss: 3.9060166
	speed: 0.0997s/iter; left time: 1545.6116s
	iters: 2000, epoch: 4 | loss: 3.3842244
	speed: 0.0956s/iter; left time: 1471.1889s
	iters: 2100, epoch: 4 | loss: 4.4651170
	speed: 0.0979s/iter; left time: 1498.1059s
	iters: 2200, epoch: 4 | loss: 3.4771175
	speed: 0.0906s/iter; left time: 1377.0429s
	iters: 2300, epoch: 4 | loss: 4.2440033
	speed: 0.0841s/iter; left time: 1269.0474s
	iters: 2400, epoch: 4 | loss: 3.6002710
	speed: 0.0873s/iter; left time: 1309.8177s
Epoch: 4 cost time: 235.3634157180786
Epoch: 4, Steps: 2485 | Train Loss: 5.0254669 Vali Loss: 45.7986145 Test Loss: 9.4563398
EarlyStopping counter: 3 out of 10
type1 => Adjust updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 6.0710988
	speed: 0.3967s/iter; left time: 5875.6884s
	iters: 200, epoch: 5 | loss: 4.0154500
	speed: 0.0849s/iter; left time: 1249.1118s
	iters: 300, epoch: 5 | loss: 3.8507078
	speed: 0.1024s/iter; left time: 1496.5313s
	iters: 400, epoch: 5 | loss: 3.5183537
	speed: 0.0853s/iter; left time: 1237.3795s
	iters: 500, epoch: 5 | loss: 5.5767503
	speed: 0.0844s/iter; left time: 1215.5788s
	iters: 600, epoch: 5 | loss: 8.2040491
	speed: 0.0849s/iter; left time: 1214.2919s
	iters: 700, epoch: 5 | loss: 7.4268675
	speed: 0.0921s/iter; left time: 1308.9613s
	iters: 800, epoch: 5 | loss: 10.5230455
	speed: 0.0869s/iter; left time: 1225.8374s
	iters: 900, epoch: 5 | loss: 7.9042611
	speed: 0.0918s/iter; left time: 1286.6833s
	iters: 1000, epoch: 5 | loss: 5.3398581
	speed: 0.0862s/iter; left time: 1199.2358s
	iters: 1100, epoch: 5 | loss: 4.6557021
	speed: 0.0862s/iter; left time: 1190.7493s
	iters: 1200, epoch: 5 | loss: 4.8532057
	speed: 0.0909s/iter; left time: 1245.7274s
	iters: 1300, epoch: 5 | loss: 6.8532491
	speed: 0.0857s/iter; left time: 1166.9839s
	iters: 1400, epoch: 5 | loss: 3.7342942
	speed: 0.0859s/iter; left time: 1160.4894s
	iters: 1500, epoch: 5 | loss: 5.6103148
	speed: 0.0823s/iter; left time: 1104.2635s
	iters: 1600, epoch: 5 | loss: 5.0752211
	speed: 0.0936s/iter; left time: 1245.3458s
	iters: 1700, epoch: 5 | loss: 5.9978771
	speed: 0.0863s/iter; left time: 1139.8651s
	iters: 1800, epoch: 5 | loss: 5.5046320
	speed: 0.0911s/iter; left time: 1193.9325s
	iters: 1900, epoch: 5 | loss: 5.3446259
	speed: 0.1105s/iter; left time: 1437.9115s
	iters: 2000, epoch: 5 | loss: 4.1419244
	speed: 0.1121s/iter; left time: 1446.9534s
	iters: 2100, epoch: 5 | loss: 4.9826970
	speed: 0.0956s/iter; left time: 1224.9211s
	iters: 2200, epoch: 5 | loss: 3.7483625
	speed: 0.0897s/iter; left time: 1140.0300s
	iters: 2300, epoch: 5 | loss: 4.8401356
	speed: 0.0878s/iter; left time: 1107.5740s
	iters: 2400, epoch: 5 | loss: 4.6753831
	speed: 0.0927s/iter; left time: 1160.3880s
Epoch: 5 cost time: 226.1715748310089
Epoch: 5, Steps: 2485 | Train Loss: 5.6781360 Vali Loss: 44.8349304 Test Loss: 9.2109690
EarlyStopping counter: 4 out of 10
type1 => Adjust updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 6.9012413
	speed: 0.3844s/iter; left time: 4738.2810s
	iters: 200, epoch: 6 | loss: 5.6356936
	speed: 0.0866s/iter; left time: 1058.2751s
	iters: 300, epoch: 6 | loss: 5.4454288
	speed: 0.0870s/iter; left time: 1055.2303s
	iters: 400, epoch: 6 | loss: 9.3188982
	speed: 0.0839s/iter; left time: 1008.6333s
	iters: 500, epoch: 6 | loss: 9.7838917
	speed: 0.0810s/iter; left time: 965.6642s
	iters: 600, epoch: 6 | loss: 16.4319229
	speed: 0.0816s/iter; left time: 964.7903s
	iters: 700, epoch: 6 | loss: 18.9920216
	speed: 0.0896s/iter; left time: 1050.5213s
	iters: 800, epoch: 6 | loss: 21.9751835
	speed: 0.0935s/iter; left time: 1087.0173s
	iters: 900, epoch: 6 | loss: 14.9869881
	speed: 0.0899s/iter; left time: 1036.2954s
	iters: 1000, epoch: 6 | loss: 19.6329498
	speed: 0.0903s/iter; left time: 1032.1567s
	iters: 1100, epoch: 6 | loss: 21.5556679
	speed: 0.0867s/iter; left time: 981.5664s
	iters: 1200, epoch: 6 | loss: 17.4394169
	speed: 0.0924s/iter; left time: 1037.7445s
	iters: 1300, epoch: 6 | loss: 11.1101656
	speed: 0.0846s/iter; left time: 941.5417s
	iters: 1400, epoch: 6 | loss: 6.5725284
	speed: 0.0996s/iter; left time: 1098.1965s
	iters: 1500, epoch: 6 | loss: 19.0280495
	speed: 0.0839s/iter; left time: 916.2632s
	iters: 1600, epoch: 6 | loss: 20.2924175
	speed: 0.0921s/iter; left time: 997.2196s
	iters: 1700, epoch: 6 | loss: 20.9060822
	speed: 0.0968s/iter; left time: 1037.8597s
	iters: 1800, epoch: 6 | loss: 22.3634281
	speed: 0.0949s/iter; left time: 1008.5775s
	iters: 1900, epoch: 6 | loss: 17.9710655
	speed: 0.0893s/iter; left time: 940.3230s
	iters: 2000, epoch: 6 | loss: 15.6382170
	speed: 0.0849s/iter; left time: 885.1847s
	iters: 2100, epoch: 6 | loss: 19.9356804
	speed: 0.0957s/iter; left time: 988.7009s
	iters: 2200, epoch: 6 | loss: 15.1269217
	speed: 0.1038s/iter; left time: 1061.2107s
	iters: 2300, epoch: 6 | loss: 22.2939377
	speed: 0.0987s/iter; left time: 999.9179s
	iters: 2400, epoch: 6 | loss: 15.4863520
	speed: 0.0918s/iter; left time: 920.0542s
Epoch: 6 cost time: 223.6916868686676
Epoch: 6, Steps: 2485 | Train Loss: 15.6494631 Vali Loss: 44.4512329 Test Loss: 9.3340340
EarlyStopping counter: 5 out of 10
type1 => Adjust updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 5.6778450
	speed: 0.3642s/iter; left time: 3584.2779s
	iters: 200, epoch: 7 | loss: 4.5906882
	speed: 0.0865s/iter; left time: 842.3471s
	iters: 300, epoch: 7 | loss: 4.3034472
	speed: 0.0865s/iter; left time: 833.7683s
	iters: 400, epoch: 7 | loss: 3.8951163
	speed: 0.0870s/iter; left time: 830.5433s
	iters: 500, epoch: 7 | loss: 3.7043133
	speed: 0.0992s/iter; left time: 936.2380s
	iters: 600, epoch: 7 | loss: 7.6600008
	speed: 0.0979s/iter; left time: 914.3337s
	iters: 700, epoch: 7 | loss: 7.6590896
	speed: 0.0828s/iter; left time: 765.5823s
	iters: 800, epoch: 7 | loss: 8.7432308
	speed: 0.0854s/iter; left time: 781.0679s
	iters: 900, epoch: 7 | loss: 8.2155323
	speed: 0.0882s/iter; left time: 797.2728s
	iters: 1000, epoch: 7 | loss: 7.8160563
	speed: 0.0839s/iter; left time: 750.3987s
	iters: 1100, epoch: 7 | loss: 5.8689799
	speed: 0.0862s/iter; left time: 761.9998s
	iters: 1200, epoch: 7 | loss: 7.4221344
	speed: 0.0892s/iter; left time: 779.9447s
	iters: 1300, epoch: 7 | loss: 6.8100691
	speed: 0.1092s/iter; left time: 943.7000s
	iters: 1400, epoch: 7 | loss: 5.0674109
	speed: 0.0824s/iter; left time: 704.0218s
	iters: 1500, epoch: 7 | loss: 5.0242753
	speed: 0.0864s/iter; left time: 729.4143s
	iters: 1600, epoch: 7 | loss: 5.2106724
	speed: 0.0812s/iter; left time: 677.1300s
	iters: 1700, epoch: 7 | loss: 5.6790071
	speed: 0.0785s/iter; left time: 646.9041s
	iters: 1800, epoch: 7 | loss: 5.0794959
	speed: 0.0791s/iter; left time: 643.9975s
	iters: 1900, epoch: 7 | loss: 5.0406814
	speed: 0.0736s/iter; left time: 591.4573s
	iters: 2000, epoch: 7 | loss: 5.3037515
	speed: 0.0850s/iter; left time: 674.7887s
	iters: 2100, epoch: 7 | loss: 5.1429367
	speed: 0.0863s/iter; left time: 677.0547s
	iters: 2200, epoch: 7 | loss: 4.6227107
	speed: 0.0893s/iter; left time: 690.9552s
	iters: 2300, epoch: 7 | loss: 4.4008179
	speed: 0.0903s/iter; left time: 689.8656s
	iters: 2400, epoch: 7 | loss: 4.7392168
	speed: 0.0747s/iter; left time: 562.9395s
Epoch: 7 cost time: 215.39886689186096
Epoch: 7, Steps: 2485 | Train Loss: 5.7776382 Vali Loss: 42.2789383 Test Loss: 7.6253681
EarlyStopping counter: 6 out of 10
type1 => Adjust updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 5.1420479
	speed: 0.3835s/iter; left time: 2821.2847s
	iters: 200, epoch: 8 | loss: 3.7498705
	speed: 0.0785s/iter; left time: 569.2416s
	iters: 300, epoch: 8 | loss: 3.4305708
	speed: 0.0785s/iter; left time: 561.3978s
	iters: 400, epoch: 8 | loss: 7.8384428
	speed: 0.0791s/iter; left time: 558.0973s
	iters: 500, epoch: 8 | loss: 12.6416225
	speed: 0.0800s/iter; left time: 556.4143s
	iters: 600, epoch: 8 | loss: 22.6160717
	speed: 0.0794s/iter; left time: 544.6011s
	iters: 700, epoch: 8 | loss: 26.2404060
	speed: 0.0781s/iter; left time: 527.4184s
	iters: 800, epoch: 8 | loss: 22.6496201
	speed: 0.0752s/iter; left time: 500.2691s
	iters: 900, epoch: 8 | loss: 18.1839962
	speed: 0.0787s/iter; left time: 515.9286s
	iters: 1000, epoch: 8 | loss: 19.0882549
	speed: 0.0797s/iter; left time: 514.4411s
	iters: 1100, epoch: 8 | loss: 18.9517365
	speed: 0.0767s/iter; left time: 487.1889s
	iters: 1200, epoch: 8 | loss: 20.3626499
	speed: 0.0729s/iter; left time: 456.1715s
	iters: 1300, epoch: 8 | loss: 12.1618690
	speed: 0.0829s/iter; left time: 510.1964s
	iters: 1400, epoch: 8 | loss: 6.4804606
	speed: 0.0781s/iter; left time: 473.0700s
	iters: 1500, epoch: 8 | loss: 20.2317486
	speed: 0.0925s/iter; left time: 550.7500s
	iters: 1600, epoch: 8 | loss: 21.4021358
	speed: 0.0706s/iter; left time: 413.7260s
	iters: 1700, epoch: 8 | loss: 26.6929150
	speed: 0.0786s/iter; left time: 452.3817s
	iters: 1800, epoch: 8 | loss: 27.7839012
	speed: 0.0792s/iter; left time: 447.7015s
	iters: 1900, epoch: 8 | loss: 25.6346436
	speed: 0.0836s/iter; left time: 464.4904s
	iters: 2000, epoch: 8 | loss: 25.3758030
	speed: 0.0683s/iter; left time: 372.5570s
	iters: 2100, epoch: 8 | loss: 24.8468304
	speed: 0.0823s/iter; left time: 440.5651s
	iters: 2200, epoch: 8 | loss: 22.5662003
	speed: 0.0791s/iter; left time: 416.0036s
	iters: 2300, epoch: 8 | loss: 29.3781719
	speed: 0.0806s/iter; left time: 415.4918s
	iters: 2400, epoch: 8 | loss: 23.1263466
	speed: 0.0792s/iter; left time: 400.6088s
Epoch: 8 cost time: 196.55710434913635
Epoch: 8, Steps: 2485 | Train Loss: 18.8355558 Vali Loss: 41.9423866 Test Loss: 7.0464354
EarlyStopping counter: 7 out of 10
type1 => Adjust updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 10.4819498
	speed: 0.3552s/iter; left time: 1730.2476s
	iters: 200, epoch: 9 | loss: 7.3042450
	speed: 0.1018s/iter; left time: 485.6617s
	iters: 300, epoch: 9 | loss: 8.9778805
	speed: 0.1011s/iter; left time: 472.1770s
	iters: 400, epoch: 9 | loss: 6.0544214
	speed: 0.0879s/iter; left time: 401.7575s
	iters: 500, epoch: 9 | loss: 13.9526682
	speed: 0.0859s/iter; left time: 383.8757s
	iters: 600, epoch: 9 | loss: 27.7480259
	speed: 0.1042s/iter; left time: 455.3169s
	iters: 700, epoch: 9 | loss: 32.6891403
	speed: 0.1161s/iter; left time: 495.7695s
	iters: 800, epoch: 9 | loss: 38.1254768
	speed: 0.0914s/iter; left time: 381.3258s
	iters: 900, epoch: 9 | loss: 32.2355537
	speed: 0.1039s/iter; left time: 422.8007s
	iters: 1000, epoch: 9 | loss: 30.2540283
	speed: 0.1052s/iter; left time: 417.7974s
	iters: 1100, epoch: 9 | loss: 29.4671135
	speed: 0.0961s/iter; left time: 371.8738s
	iters: 1200, epoch: 9 | loss: 33.9582787
	speed: 0.0967s/iter; left time: 364.4904s
	iters: 1300, epoch: 9 | loss: 23.6271172
	speed: 0.1029s/iter; left time: 377.6141s
	iters: 1400, epoch: 9 | loss: 9.4734831
	speed: 0.1016s/iter; left time: 362.7735s
	iters: 1500, epoch: 9 | loss: 29.7598877
	speed: 0.0984s/iter; left time: 341.5870s
	iters: 1600, epoch: 9 | loss: 31.7508602
	speed: 0.0954s/iter; left time: 321.6158s
	iters: 1700, epoch: 9 | loss: 34.8688850
	speed: 0.1066s/iter; left time: 348.5424s
	iters: 1800, epoch: 9 | loss: 31.8486652
	speed: 0.0990s/iter; left time: 313.9429s
	iters: 1900, epoch: 9 | loss: 30.4544907
	speed: 0.0966s/iter; left time: 296.7366s
	iters: 2000, epoch: 9 | loss: 31.9305344
	speed: 0.1014s/iter; left time: 301.2091s
	iters: 2100, epoch: 9 | loss: 36.1138573
	speed: 0.1063s/iter; left time: 305.3238s
	iters: 2200, epoch: 9 | loss: 30.3795834
	speed: 0.0914s/iter; left time: 253.2866s
	iters: 2300, epoch: 9 | loss: 38.1377182
	speed: 0.0895s/iter; left time: 239.1330s
	iters: 2400, epoch: 9 | loss: 29.3207264
	speed: 0.0907s/iter; left time: 233.1467s
Epoch: 9 cost time: 242.79008626937866
Epoch: 9, Steps: 2485 | Train Loss: 26.9608153 Vali Loss: 41.0713005 Test Loss: 6.6334615
Validation loss decreased (41.909416 --> 41.071301).  Saving model ...
type1 => Adjust updating learning rate to 3.90625e-07
	iters: 100, epoch: 10 | loss: 4.9613729
	speed: 0.4044s/iter; left time: 964.9110s
	iters: 200, epoch: 10 | loss: 4.8701878
	speed: 0.0856s/iter; left time: 195.6191s
	iters: 300, epoch: 10 | loss: 6.1449289
	speed: 0.0951s/iter; left time: 207.9663s
	iters: 400, epoch: 10 | loss: 13.6335878
	speed: 0.1025s/iter; left time: 213.8825s
	iters: 500, epoch: 10 | loss: 16.6160545
	speed: 0.0921s/iter; left time: 183.0000s
	iters: 600, epoch: 10 | loss: 30.4724083
	speed: 0.0845s/iter; left time: 159.4274s
	iters: 700, epoch: 10 | loss: 30.5608063
	speed: 0.0816s/iter; left time: 145.7012s
	iters: 800, epoch: 10 | loss: 36.3198433
	speed: 0.0848s/iter; left time: 142.9059s
	iters: 900, epoch: 10 | loss: 25.3257427
	speed: 0.0888s/iter; left time: 140.8564s
	iters: 1000, epoch: 10 | loss: 34.1133347
	speed: 0.0915s/iter; left time: 135.9028s
	iters: 1100, epoch: 10 | loss: 37.6379662
	speed: 0.0983s/iter; left time: 136.2939s
	iters: 1200, epoch: 10 | loss: 35.0245628
	speed: 0.0956s/iter; left time: 122.9546s
	iters: 1300, epoch: 10 | loss: 17.1953087
	speed: 0.0913s/iter; left time: 108.3292s
	iters: 1400, epoch: 10 | loss: 9.2741566
	speed: 0.0868s/iter; left time: 94.2156s
	iters: 1500, epoch: 10 | loss: 35.6893578
	speed: 0.0977s/iter; left time: 96.2848s
	iters: 1600, epoch: 10 | loss: 39.3610191
	speed: 0.0859s/iter; left time: 76.0739s
	iters: 1700, epoch: 10 | loss: 50.3028831
	speed: 0.0833s/iter; left time: 65.4395s
	iters: 1800, epoch: 10 | loss: 47.7639847
	speed: 0.0937s/iter; left time: 64.2904s
	iters: 1900, epoch: 10 | loss: 43.7915268
	speed: 0.0926s/iter; left time: 54.2791s
	iters: 2000, epoch: 10 | loss: 42.0413246
	speed: 0.0902s/iter; left time: 43.8583s
	iters: 2100, epoch: 10 | loss: 47.0000954
	speed: 0.0975s/iter; left time: 37.6342s
	iters: 2200, epoch: 10 | loss: 41.8971901
	speed: 0.0979s/iter; left time: 27.9878s
	iters: 2300, epoch: 10 | loss: 51.9695778
	speed: 0.0735s/iter; left time: 13.6794s
	iters: 2400, epoch: 10 | loss: 43.0212479
	speed: 0.0833s/iter; left time: 7.1603s
Epoch: 10 cost time: 224.38999581336975
Epoch: 10, Steps: 2485 | Train Loss: 30.5878928 Vali Loss: 40.8504906 Test Loss: 6.4338160
Validation loss decreased (41.071301 --> 40.850491).  Saving model ...
type1 => Adjust updating learning rate to 1.953125e-07
>>>>>>>testing : CBS_36_72_FEDformer_CBS_ftM_sl36_ll4_pl72_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_test_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
data shape:  (720, 4454) 4454
loading model.............
mse:6.433813571929932, mae:1.4736146926879883, rse:0.7670997977256775
